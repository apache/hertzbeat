"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[30013],{83595(e,r,i){i.r(r),i.d(r,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"help/zookeeper_sd","title":"Monitoring Zookeeper Service Discovery","description":"HertzBeat integrates with Zookeeper to automatically discover service instances stored in Zookeeper nodes and create monitoring tasks for them.","source":"@site/docs/help/zookeeper_sd.md","sourceDirName":"help","slug":"/help/zookeeper_sd","permalink":"/docs/next/help/zookeeper_sd","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hertzbeat/edit/master/home/docs/help/zookeeper_sd.md","tags":[],"version":"current","frontMatter":{"id":"zookeeper_sd","title":"Monitoring Zookeeper Service Discovery","sidebar_label":"Zookeeper Service Discovery","keywords":["open source monitoring tool","open source service discovery monitoring tool","monitoring Zookeeper service discovery"]},"sidebar":"docs","previous":{"title":"Consul Service Discovery","permalink":"/docs/next/help/consul_sd"},"next":{"title":"HTTP Service Discovery","permalink":"/docs/next/help/http_sd"}}');var s=i(86070),o=i(60056);const t={id:"zookeeper_sd",title:"Monitoring Zookeeper Service Discovery",sidebar_label:"Zookeeper Service Discovery",keywords:["open source monitoring tool","open source service discovery monitoring tool","monitoring Zookeeper service discovery"]},c=void 0,l={},d=[{value:"Overview",id:"overview",level:3},{value:"PreRequisites",id:"prerequisites",level:3},{value:"Deploy Zookeeper Server",id:"deploy-zookeeper-server",level:4},{value:"Configuration parameter",id:"configuration-parameter",level:3},{value:"Usage Steps",id:"usage-steps",level:3},{value:"Example of usage",id:"example-of-usage",level:3},{value:"Example 1: Dubbo Service Discovery",id:"example-1-dubbo-service-discovery",level:4},{value:"Example 2: Custom Service Discovery",id:"example-2-custom-service-discovery",level:4},{value:"Notes",id:"notes",level:3},{value:"Collection Metric",id:"collection-metric",level:3},{value:"Metric set: Monitor Target",id:"metric-set-monitor-target",level:4},{value:"Use Cases",id:"use-cases",level:3},{value:"Common Dubbo Path Structure",id:"common-dubbo-path-structure",level:3}];function a(e){const r={a:"a",blockquote:"blockquote",code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"HertzBeat integrates with Zookeeper to automatically discover service instances stored in Zookeeper nodes and create monitoring tasks for them."}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(r.p,{children:"Zookeeper Service Discovery allows HertzBeat to connect to your Zookeeper server and automatically discover service instance information stored in specific path nodes. This is commonly used in Dubbo and other RPC frameworks that use Zookeeper as a registry center. When service instances change, HertzBeat will automatically create or delete corresponding monitoring tasks."}),"\n",(0,s.jsx)(r.h3,{id:"prerequisites",children:"PreRequisites"}),"\n",(0,s.jsx)(r.h4,{id:"deploy-zookeeper-server",children:"Deploy Zookeeper Server"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["Deploy Zookeeper server according to ",(0,s.jsx)(r.a,{href:"https://zookeeper.apache.org/doc/current/zookeeperStarted.html",children:"Zookeeper official documentation"}),"."]}),"\n",(0,s.jsx)(r.li,{children:"Ensure Zookeeper server is accessible from HertzBeat."}),"\n",(0,s.jsx)(r.li,{children:"Verify Zookeeper is running properly using Zookeeper client tools"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"configuration-parameter",children:"Configuration parameter"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter name"}),(0,s.jsx)(r.th,{children:"Parameter help description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Target Name"}),(0,s.jsx)(r.td,{children:"Identify the name of this monitoring. The name needs to be unique."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Service Discovery Url"}),(0,s.jsxs)(r.td,{children:["Zookeeper server connection address. Example: ",(0,s.jsx)(r.code,{children:"192.168.1.100:2181"})," or ",(0,s.jsx)(r.code,{children:"zk1:2181,zk2:2181,zk3:2181"})," (cluster mode)"]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Service Discovery Path Prefix"}),(0,s.jsxs)(r.td,{children:["The path prefix in Zookeeper for service discovery. Example: ",(0,s.jsx)(r.code,{children:"/dubbo"})," or ",(0,s.jsx)(r.code,{children:"/services"})]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Collection interval"}),(0,s.jsx)(r.td,{children:"Interval time of monitor periodic data collection, unit: second, and the minimum interval that can be set is 30 seconds."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Description remarks"}),(0,s.jsx)(r.td,{children:"For more information about identifying and describing this monitoring, users can note information here."})]})]})]}),"\n",(0,s.jsx)(r.h3,{id:"usage-steps",children:"Usage Steps"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Create Service Discovery Monitoring"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["In HertzBeat web UI, navigate to ",(0,s.jsx)(r.strong,{children:"Monitoring"})," \u2192 ",(0,s.jsx)(r.strong,{children:"New Monitoring"})]}),"\n",(0,s.jsxs)(r.li,{children:["Select monitoring type: ",(0,s.jsx)(r.strong,{children:"Zookeeper Service Discovery"})]}),"\n",(0,s.jsx)(r.li,{children:"Fill in the basic configuration parameters"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Configure Monitoring Template"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"After creating the service discovery monitoring, you need to specify a monitoring template"}),"\n",(0,s.jsx)(r.li,{children:"The template defines what type of monitoring to create for discovered service instances"}),"\n",(0,s.jsx)(r.li,{children:"For example: If discovered instances are Dubbo services, you can select Port monitoring template"}),"\n",(0,s.jsx)(r.li,{children:"Common template types: Port, HTTP, Ping, etc."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Automatic Discovery"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"HertzBeat will periodically query Zookeeper based on the collection interval"}),"\n",(0,s.jsx)(r.li,{children:"Automatically create monitoring tasks for newly discovered service instances"}),"\n",(0,s.jsx)(r.li,{children:"Automatically delete monitoring tasks for disappeared service instances"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"View Discovered Instances"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"In the monitoring list, you can see all automatically created sub-monitoring tasks"}),"\n",(0,s.jsx)(r.li,{children:"Each sub-monitoring task corresponds to a discovered service instance"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"example-of-usage",children:"Example of usage"}),"\n",(0,s.jsx)(r.h4,{id:"example-1-dubbo-service-discovery",children:"Example 1: Dubbo Service Discovery"}),"\n",(0,s.jsxs)(r.p,{children:["Suppose you have a Dubbo service registry running in Zookeeper at ",(0,s.jsx)(r.code,{children:"192.168.1.100:2181"}),", and service information is stored under the ",(0,s.jsx)(r.code,{children:"/dubbo"})," path."]}),"\n",(0,s.jsx)(r.p,{children:"Configuration example:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Target Name"}),": ",(0,s.jsx)(r.code,{children:"Zookeeper-Dubbo-Discovery"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Service Discovery Url"}),": ",(0,s.jsx)(r.code,{children:"192.168.1.100:2181"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Service Discovery Path Prefix"}),": ",(0,s.jsx)(r.code,{children:"/dubbo"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Collection interval"}),": ",(0,s.jsx)(r.code,{children:"60"})," seconds"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Monitoring Template"}),": Select ",(0,s.jsx)(r.code,{children:"Port"})," monitoring"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"After configuration:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"HertzBeat connects to Zookeeper"}),"\n",(0,s.jsxs)(r.li,{children:["Retrieves all child nodes under the ",(0,s.jsx)(r.code,{children:"/dubbo"})," path"]}),"\n",(0,s.jsx)(r.li,{children:"Parses node information to extract service instance host and port"}),"\n",(0,s.jsx)(r.li,{children:"Automatically creates Port monitoring for each service instance"}),"\n"]}),"\n",(0,s.jsx)(r.h4,{id:"example-2-custom-service-discovery",children:"Example 2: Custom Service Discovery"}),"\n",(0,s.jsxs)(r.p,{children:["If you have a custom service registration mechanism using Zookeeper, and service information is stored under the ",(0,s.jsx)(r.code,{children:"/services"})," path:"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Service Discovery Url"}),": ",(0,s.jsx)(r.code,{children:"zk1:2181,zk2:2181,zk3:2181"})," (Zookeeper cluster)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Service Discovery Path Prefix"}),": ",(0,s.jsx)(r.code,{children:"/services"})]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"HertzBeat will discover all service instances under this path."}),"\n",(0,s.jsx)(r.h3,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Node Format"}),": Zookeeper service discovery expects child nodes to contain host",":port"," information","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Example node name format: ",(0,s.jsx)(r.code,{children:"192.168.1.101:8080"})," or similar formats"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Network Connectivity"}),": Ensure HertzBeat can access the Zookeeper server address and port (default: 2181)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Monitoring Templates"}),": Service discovery only discovers service instance addresses, you need to configure appropriate monitoring templates to actually monitor the instances"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Collection Interval"}),": Recommended minimum interval is 60 seconds to avoid excessive requests to Zookeeper"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Path Prefix"}),": Ensure the path prefix is correct and HertzBeat has permission to read nodes under this path"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Cluster Mode"}),": Supports Zookeeper cluster mode, multiple addresses can be separated by commas"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Instance Naming"}),": Automatically created monitoring tasks are named based on node information"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"collection-metric",children:"Collection Metric"}),"\n",(0,s.jsx)(r.h4,{id:"metric-set-monitor-target",children:"Metric set: Monitor Target"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Metric name"}),(0,s.jsx)(r.th,{children:"Metric unit"}),(0,s.jsx)(r.th,{children:"Metric help description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"target"}),(0,s.jsx)(r.td,{children:"none"}),(0,s.jsx)(r.td,{children:"Discovered service instance target"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"host"}),(0,s.jsx)(r.td,{children:"none"}),(0,s.jsx)(r.td,{children:"Service instance host address"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"port"}),(0,s.jsx)(r.td,{children:"none"}),(0,s.jsx)(r.td,{children:"Service instance port number"})]})]})]}),"\n",(0,s.jsx)(r.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Dubbo Services"}),": Automatically monitor Dubbo service providers and consumers registered in Zookeeper"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"RPC Frameworks"}),": Monitor RPC services using Zookeeper as a registry"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Custom Registration"}),": Monitor services using custom Zookeeper-based service registration"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Distributed Systems"}),": Manage monitoring of distributed system components using Zookeeper for coordination"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Service Governance"}),": Centrally manage monitoring of services in the Zookeeper service ecosystem"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"common-dubbo-path-structure",children:"Common Dubbo Path Structure"}),"\n",(0,s.jsx)(r.p,{children:"For Dubbo services, typical Zookeeper path structures include:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"/dubbo/{serviceName}/providers"})," - Service provider addresses"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"/dubbo/{serviceName}/consumers"})," - Service consumer addresses"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"/dubbo/{serviceName}/routers"})," - Routing rules"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"/dubbo/{serviceName}/configurators"})," - Configuration overrides"]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["When using Zookeeper service discovery with Dubbo, it's recommended to set the path prefix to ",(0,s.jsx)(r.code,{children:"/dubbo"})," to discover all Dubbo services."]})]})}function h(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},60056(e,r,i){i.d(r,{R:()=>t,x:()=>c});var n=i(30758);const s={},o=n.createContext(s);function t(e){const r=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),n.createElement(o.Provider,{value:r},e.children)}}}]);