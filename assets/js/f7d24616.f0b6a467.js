"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[85067],{45906:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>i});var t=r(30758);const a={},l=t.createContext(a);function s(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(l.Provider,{value:n},e.children)}},92744:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});var t=r(98178),a=r(86070),l=r(45906);const s={},i="HertzBeat Upgrade Guide from v1.6.1 to v1.7.0 (Helm Mode)",c={authorsImageUrls:[]},d=[{value:"1. Prerequisites",id:"1-prerequisites",level:2},{value:"2. Upgrade Steps",id:"2-upgrade-steps",level:2},{value:"1. Pull the latest Chart",id:"1-pull-the-latest-chart",level:3},{value:"2. Update values.yaml",id:"2-update-valuesyaml",level:3},{value:"3. Dry-run Upgrade",id:"3-dry-run-upgrade",level:3},{value:"4. Execute Upgrade",id:"4-execute-upgrade",level:3},{value:"5. Verify Upgrade",id:"5-verify-upgrade",level:3}];function o(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"1-prerequisites",children:"1. Prerequisites"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Ensure the following tools are installed:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Helm 3.x"}),"\n",(0,a.jsx)(n.li,{children:"kubectl"}),"\n",(0,a.jsx)(n.li,{children:"Git (optional)"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Verify current deployment information:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm list -n <your-namespace>\n# If the old chart package is missing, export values.yaml with:\nhelm get values hertzbeat -n <your-namespace> > hertzbeat-1.6.1-values.yaml\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Data Backup:"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"For custom monitoring templates:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Backup ",(0,a.jsx)(n.code,{children:"/opt/hertzbeat/define"})," from the running pod:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl cp hertzbeat/hertzbeat-978477f84-fr894:/opt/hertzbeat/define ./define\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"For external databases (MySQL/PostgreSQL):"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"mysqldump"}),"/",(0,a.jsx)(n.code,{children:"pg_dump"})," or copy PVC directories:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl get pvc -n hertzbeat\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"2-upgrade-steps",children:"2. Upgrade Steps"}),"\n",(0,a.jsx)(n.h3,{id:"1-pull-the-latest-chart",children:"1. Pull the latest Chart"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm repo update\nhelm pull hertzbeat/hertzbeat --version 1.7.0 --untar\ncd hertzbeat\n"})}),"\n",(0,a.jsx)(n.p,{children:"Or clone from GitHub:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/hertzbeat/helm-charts.git\ncd helm-charts/charts/hertzbeat\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2-update-valuesyaml",children:"2. Update values.yaml"}),"\n",(0,a.jsx)(n.p,{children:"Compare and merge configurations:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"diff -u ../hertzbeat-1.6.1-values.yaml values.yaml\n# Use vimdiff to compare and merge changes\n"})}),"\n",(0,a.jsx)(n.p,{children:"Key configurations to check:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"image.tag"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"resources"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"persistence"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"service.type"})}),"\n",(0,a.jsx)(n.li,{children:"Ingress settings"}),"\n",(0,a.jsx)(n.li,{children:"External database configurations"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"3-dry-run-upgrade",children:"3. Dry-run Upgrade"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm upgrade hertzbeat . -n <your-namespace> \\\n  --values values.yaml \\\n  --dry-run \\\n  --debug\n"})}),"\n",(0,a.jsx)(n.h3,{id:"4-execute-upgrade",children:"4. Execute Upgrade"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm upgrade hertzbeat . -n <your-namespace> \\\n  --values values.yaml \\\n  --atomic \\          # Auto-rollback on failure\n  --timeout 10m       # Set timeout\n"})}),"\n",(0,a.jsx)(n.h3,{id:"5-verify-upgrade",children:"5. Verify Upgrade"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm status hertzbeat -n <your-namespace>\nkubectl get pods -n <your-namespace> -l app.kubernetes.io/instance=hertzbeat\nkubectl logs -n <your-namespace> -l app.kubernetes.io/instance=hertzbeat --tail=100\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},98178:e=>{e.exports=JSON.parse('{"permalink":"/blog/2025/04/23/hertzbeat-upgrade-guide-from-v1.6.1-to-v1.7.0-helm-mode","editUrl":"https://github.com/apache/hertzbeat/edit/master/home/blog/2025-04-23-hertzbeat-upgrade-guide-from-v1.6.1-to-v1.7.0-helm-mode.md","source":"@site/blog/2025-04-23-hertzbeat-upgrade-guide-from-v1.6.1-to-v1.7.0-helm-mode.md","title":"HertzBeat Upgrade Guide from v1.6.1 to v1.7.0 (Helm Mode)","description":"1. Prerequisites","date":"2025-04-23T00:00:00.000Z","tags":[],"readingTime":1.15,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"HertzBeat Upgrade Guide (Docker Mode)","permalink":"/blog/2025/04/23/hertzbeat-upgrade-guide-docker-mode"},"nextItem":{"title":"Announcement of Apache HertzBeat\u2122 1.7.0 Release","permalink":"/blog/2025/04/10/hertzbeat-v1.7.0"}}')}}]);