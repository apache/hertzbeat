"use strict";(self.webpackChunkhertzbeat=self.webpackChunkhertzbeat||[]).push([[25811],{15680:(e,t,a)=>{a.d(t,{xA:()=>d,yg:()=>m});var r=a(96540);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),g=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=g(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),h=g(a),m=n,u=h["".concat(s,".").concat(m)]||h[m]||p[m]||l;return a?r.createElement(u,i(i({ref:t},d),{},{components:a})):r.createElement(u,i({ref:t},d))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=h;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:n,i[1]=o;for(var g=2;g<l;g++)i[g]=a[g];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},5715:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>g});var r=a(58168),n=(a(96540),a(15680));const l={id:"alert_threshold",title:"Alarm Threshold Configuration",sidebar_label:"Alarm Threshold"},i=void 0,o={unversionedId:"help/alert_threshold",id:"help/alert_threshold",title:"Alarm Threshold Configuration",description:"Alarm Threshold are the core function of HertzBeat, users can configure the trigger conditions of the alarm through the threshold rules.",source:"@site/docs/help/alert_threshold.md",sourceDirName:"help",slug:"/help/alert_threshold",permalink:"/docs/help/alert_threshold",draft:!1,editUrl:"https://github.com/apache/hertzbeat/edit/master/home/docs/help/alert_threshold.md",tags:[],version:"current",frontMatter:{id:"alert_threshold",title:"Alarm Threshold Configuration",sidebar_label:"Alarm Threshold"},sidebar:"docs",previous:{title:"Alarm Center",permalink:"/docs/help/alarm_center"},next:{title:"Threshold Trigger Expression",permalink:"/docs/help/alert_threshold_expr"}},s={},g=[{value:"Real-time Threshold",id:"real-time-threshold",level:2},{value:"Creating Real-time Threshold Rules",id:"creating-real-time-threshold-rules",level:3},{value:"Monitoring Metrics Real-time Threshold",id:"monitoring-metrics-real-time-threshold",level:4},{value:"Log Data Real-time Threshold",id:"log-data-real-time-threshold",level:4},{value:"Scheduled Threshold",id:"scheduled-threshold",level:2},{value:"Syntax for Scheduled Threshold Expressions",id:"syntax-for-scheduled-threshold-expressions",level:3},{value:"Monitoring Metrics Expression Syntax (PromQL)",id:"monitoring-metrics-expression-syntax-promql",level:4},{value:"Log Data Expression Syntax (SQL)",id:"log-data-expression-syntax-sql",level:4},{value:"Creating Scheduled Threshold Rules",id:"creating-scheduled-threshold-rules",level:3},{value:"Monitoring Metrics Scheduled Threshold",id:"monitoring-metrics-scheduled-threshold",level:4},{value:"Log Data Scheduled Threshold",id:"log-data-scheduled-threshold",level:4}],d={toc:g};function p(e){let{components:t,...l}=e;return(0,n.yg)("wrapper",(0,r.A)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,n.yg)("admonition",{type:"tip"},(0,n.yg)("p",{parentName:"admonition"},"Alarm Threshold are the core function of ",(0,n.yg)("inlineCode",{parentName:"p"},"HertzBeat"),", users can configure the trigger conditions of the alarm through the threshold rules.",(0,n.yg)("br",{parentName:"p"}),"\n","Threshold rules support real-time threshold and scheduled threshold, and can be applied to ",(0,n.yg)("strong",{parentName:"p"},"monitoring metrics")," and ",(0,n.yg)("strong",{parentName:"p"},"log data")," data types. Real-time thresholds can directly trigger alerts when monitoring data is collected, and scheduled thresholds support PromQL, SQL and other expressions to calculate trigger alerts within a specified time period.",(0,n.yg)("br",{parentName:"p"}),"\n","Support visual page configuration or more flexible expression rule configuration, support configuring trigger times, alarm levels, notification templates, associated specified monitoring and so on. Notification templates support object nested access, which can display alarm information more flexibly.")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"threshold",src:a(68498).A,width:"1955",height:"926"})),(0,n.yg)("h2",{id:"real-time-threshold"},"Real-time Threshold"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"Real-time threshold means that the alarm is triggered directly when the monitoring data is collected, which is suitable for scenarios with high real-time requirements. Supports both monitoring metrics and log data types.")),(0,n.yg)("h3",{id:"creating-real-time-threshold-rules"},"Creating Real-time Threshold Rules"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"System Page -> Alerting -> Alert Threshold -> New Threshold -> Select Real-time Threshold -> Select Data Type (Monitoring Metrics/Log Data)")),(0,n.yg)("h4",{id:"monitoring-metrics-real-time-threshold"},"Monitoring Metrics Real-time Threshold"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"HertzBeat Page -> Alerting -> Threshold -> New Threshold -> ReadTime Threshold Rule")),(0,n.yg)("p",null,"Configure the threshold, for example: Select the SSL certificate metric object, configure the alarm expression-triggered when the metric ",(0,n.yg)("inlineCode",{parentName:"p"},"expired")," is ",(0,n.yg)("inlineCode",{parentName:"p"},"true"),", that is, ",(0,n.yg)("inlineCode",{parentName:"p"},'equals(expired,"true")'),", set the alarm level notification template information, etc."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"HertzBeat",src:a(47029).A,width:"1937",height:"890"})),(0,n.yg)("p",null,"Configuration item details:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Threshold Name"),": Unique name defining this threshold rule"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Data Type"),": Select monitoring metrics or log data  "),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Metric Object"),": Select the monitoring metric object for which we need to configure the threshold. For example: Under website monitoring type -> response time metric"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Threshold Rule"),": Configure the alarm trigger rules for specific indicators, support graphical interface and expression rules. For expression environment variables and operators, see the page prompts. For detailed help on threshold expressions, see ",(0,n.yg)("a",{parentName:"li",href:"alert_threshold_expr"},"Threshold Expression Help")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Associated Monitors"),": Apply this threshold rule to the specified monitoring object (support direct binding and label association). If not configured, it will be applied to all monitoring objects that meet this threshold type rule"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Level"),": The alert level triggered by the threshold, from low to high: warning, critical, emergency"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Trigger Count"),": Set how many times the threshold must be triggered before the alert is actually triggered"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Notification Template"),": The template for the notification message sent after the alert is triggered. Template variables are provided on the page, supports object nested access. For example: ",(0,n.yg)("inlineCode",{parentName:"li"},"${__instancename__} ${__metric__} metric value is ${responseTime}, which is greater than 50 triggering the alert"),", also supports accessing object properties like ",(0,n.yg)("inlineCode",{parentName:"li"},"${log.attributes.hostname}")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Labels"),": Add labels to this threshold rule. When an alert is generated, these labels will also be attached to the alert"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Annotations"),": Add annotation information to this threshold rule (the annotation content supports environment variables). When an alarm is generated, this annotation information will be rendered and attached to the alarm"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Enable Alert"),": Enable or disable this alert threshold configuration")),(0,n.yg)("h4",{id:"log-data-real-time-threshold"},"Log Data Real-time Threshold"),(0,n.yg)("p",null,"Configure real-time alert rules for log data, supporting condition judgment on log content, attributes, resource information, etc."),(0,n.yg)("p",null,"For example, trigger an alert when 60 error logs are received within 300 seconds."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"log_realtime",src:a(4384).A,width:"2878",height:"1466"})),(0,n.yg)("p",null,"Configuration item details:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Threshold Name"),": Unique name defining this threshold rule"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Data Type"),": Select log data"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Threshold Rule"),": Configure log alert trigger rules, support graphical interface and expression rules:",(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Graphical Interface"),": Visual configuration of log field conditions, supports ",(0,n.yg)("inlineCode",{parentName:"li"},"log.level"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"log.message"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"log.attributes.*"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"log.resource.*")," and other fields"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Expression Rules"),": Use custom expressions, supports object nested access, for example: ",(0,n.yg)("inlineCode",{parentName:"li"},'equals(log.level,"ERROR")')," or ",(0,n.yg)("inlineCode",{parentName:"li"},'contains(log.attributes.hostname,"server-01")')))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Time Window"),": Set the time window for log aggregation, in seconds, minimum 60 seconds. Logs within this time window will be aggregated and processed"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Level"),": The alert level triggered by the threshold, from low to high: warning, critical, emergency"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Mode"),": Select alert sending method:",(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Window Group Mode (group)"),": Send all logs that meet the conditions within the time window as one alert"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Individual Mode (individual)"),": Send each log that meets the conditions as a separate alert"))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Trigger Count"),": Set how many logs that meet the conditions within the time window will trigger the alert"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Notification Template"),": The template for the notification message sent after the alert is triggered, supports object nested access:",(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},"Basic variables: ",(0,n.yg)("inlineCode",{parentName:"li"},"${__instancename__}"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"${__alertname__}"),", etc."),(0,n.yg)("li",{parentName:"ul"},"Log fields: ",(0,n.yg)("inlineCode",{parentName:"li"},"${log.level}"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"${log.message}"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"${log.timestamp}"),", etc."),(0,n.yg)("li",{parentName:"ul"},"Nested attributes: ",(0,n.yg)("inlineCode",{parentName:"li"},"${log.attributes.hostname}"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"${log.resource.service.name}"),", etc."))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Labels"),": Add labels to this threshold rule. When an alert is generated, these labels will also be attached to the alert"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Annotations"),": Add annotation information to this threshold rule (the annotation content supports environment variables). When an alarm is generated, this annotation information will be rendered and attached to the alarm"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Enable Alert"),": Enable or disable this alert threshold configuration")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"The threshold alert configuration is complete, and alerts that have been successfully triggered can be viewed in the ","[Alarm Center]","."),"\n",(0,n.yg)("strong",{parentName:"p"},"If you need to send alert notifications via email, WeChat, DingTalk, or Feishu, you can configure it in ","[Notification]",".")),(0,n.yg)("h2",{id:"scheduled-threshold"},"Scheduled Threshold"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},(0,n.yg)("strong",{parentName:"p"},"Scheduled Threshold Rules")," refer to rules where the system evaluates an expression (such as PromQL, SQL) at specified periodic intervals to determine whether monitoring data or log data within a given time range meets alert conditions. These rules are suitable for scenarios requiring trend analysis or aggregated data evaluation, rather than immediate reactions to single real-time data points. Supports both monitoring metrics and log data types.")),(0,n.yg)("h3",{id:"syntax-for-scheduled-threshold-expressions"},"Syntax for Scheduled Threshold Expressions"),(0,n.yg)("p",null,"Scheduled threshold rules use a dedicated expression language based on ANTLR syntax, supporting different query syntax based on data type:"),(0,n.yg)("h4",{id:"monitoring-metrics-expression-syntax-promql"},"Monitoring Metrics Expression Syntax (PromQL)"),(0,n.yg)("p",null,"Supports PromQL-style queries. For specific syntax, please refer to the official documentation of your configured time-series database regarding PromQL. The syntax includes:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Query Expressions"),": Used to reference monitoring data"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},'    cpu_usage\n    memory{\\__field\\__="field1"}\n'))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Comparison Expressions"),": Used to compare values against thresholds"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},"    cpu_usage > 80\n    memory_usage >= 90.5\n    response_time < 1000\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Logical Expressions"),": Used to combine multiple conditions"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},"    cpu_usage > 80 and memory_usage > 70\n    disk_usage > 90 or inode_usage > 85\n    cpu_usage > 80 unless maintenance_mode == 1\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Parenthesis Expressions"),": Used to control the order of evaluation"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},"    (cpu_usage > 80 or memory_usage > 90) and service_status == 1\n")))),(0,n.yg)("h4",{id:"log-data-expression-syntax-sql"},"Log Data Expression Syntax (SQL)"),(0,n.yg)("p",null,"Supports standard SQL syntax to query log data and filter data, allowing aggregated queries on log tables:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-sql"},"-- Query error log count\nSELECT COUNT(*) as error_count \nFROM hertzbeat_logs \nWHERE level = 'ERROR' \nAND timestamp >= NOW() - INTERVAL 5 MINUTE\n\n-- Group by service to count errors\nSELECT service_name, COUNT(*) as error_count\nFROM hertzbeat_logs \nWHERE level = 'ERROR' \nGROUP BY service_name\nHAVING COUNT(*) > 10\n")),(0,n.yg)("h3",{id:"creating-scheduled-threshold-rules"},"Creating Scheduled Threshold Rules"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"System Page -> Alerting -> Alert Threshold -> New Threshold -> Select Scheduled Threshold -> Select Data Type (Monitoring Metrics/Log Data)")),(0,n.yg)("h4",{id:"monitoring-metrics-scheduled-threshold"},"Monitoring Metrics Scheduled Threshold"),(0,n.yg)("p",null,"Configure scheduled thresholds for monitoring metrics. For example: define the expression ",(0,n.yg)("inlineCode",{parentName:"p"},'cpu_usage{instance="server1"} > 80')," for a group of CPU metrics, and trigger an alert when the expression is satisfied."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"threshold",src:a(59209).A,width:"2880",height:"1462"})),(0,n.yg)("p",null,"Configuration Items Explained:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Rule Name"),": A unique identifier for the threshold rule"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Data Type"),": Select monitoring metrics"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Query Language"),": Select PromQL as the query language"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Threshold Expression"),': The expression that defines the alert condition. It will be evaluated periodically according to the "Execution Interval". Supported elements include:',(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Query Identifiers"),": References to monitoring metrics (e.g., ",(0,n.yg)("inlineCode",{parentName:"li"},"cpu_usage"),", ",(0,n.yg)("inlineCode",{parentName:"li"},'memory{instance="server1"}'),")"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Comparison Operators"),": ",(0,n.yg)("inlineCode",{parentName:"li"},">"),", ",(0,n.yg)("inlineCode",{parentName:"li"},">="),", ",(0,n.yg)("inlineCode",{parentName:"li"},"<"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"<="),", ",(0,n.yg)("inlineCode",{parentName:"li"},"=="),", ",(0,n.yg)("inlineCode",{parentName:"li"},"!=")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Logical Operators"),": ",(0,n.yg)("inlineCode",{parentName:"li"},"and"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"or"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"unless")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Parentheses"),": Used for grouping and controlling evaluation order"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Numeric Literals"),": Threshold values (e.g., ",(0,n.yg)("inlineCode",{parentName:"li"},"80"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"90.5"),")"))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Execution Interval"),": The time interval (in seconds) at which the expression is evaluated. For example, ",(0,n.yg)("inlineCode",{parentName:"li"},"300")," means the rule is checked every 5 minutes"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Level"),": The severity level triggered when the condition is met. Available levels: ",(0,n.yg)("inlineCode",{parentName:"li"},"warning"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"critical"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"emergency")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Trigger Count"),": The number of consecutive times the expression must evaluate to true before an alert is actually triggered"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Notification Template"),": The message template sent when an alert is triggered. Template variables are available on the configuration page, supports object nested access"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Labels"),": Custom labels that will be attached to the alert when it is generated"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Annotations"),": Custom annotation information (supports environment variables) that will be rendered and attached to the alert"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Enable Alerting"),": Controls whether this threshold rule is active or not")),(0,n.yg)("h4",{id:"log-data-scheduled-threshold"},"Log Data Scheduled Threshold"),(0,n.yg)("p",null,"Configure scheduled thresholds for log data, performing aggregated analysis and alert judgment on logs through SQL queries."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"threshold",src:a(39359).A,width:"2878",height:"1464"})),(0,n.yg)("p",null,"Configuration Items Explained:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Rule Name"),": A unique identifier for the threshold rule"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Data Type"),": Select log data"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Query Language"),": Select SQL as the query language"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Log Query Expression"),": Use standard SQL syntax to query log data, supporting aggregation functions, grouping, filtering and other operations. For example:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-sql"},"SELECT COUNT(*) as error_count FROM hertzbeat_logs \nWHERE level = 'ERROR' AND timestamp >= NOW() - INTERVAL 5 MINUTE\n")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Execution Interval"),": The time interval (in seconds) at which the SQL query is executed. For example, ",(0,n.yg)("inlineCode",{parentName:"li"},"300")," means the query is executed every 5 minutes"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Level"),": The severity level triggered when the condition is met. Available levels: ",(0,n.yg)("inlineCode",{parentName:"li"},"warning"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"critical"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"emergency")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Mode"),": Select alert sending method:",(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Window Group Mode (group)"),": Send the query result as a single alert"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Individual Mode (individual)"),": Send each row in the query result as a separate alert"))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Trigger Count"),": The number of consecutive times the query result meets the alert condition before an alert is actually triggered"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Notification Template"),": The message template sent when an alert is triggered, supports accessing fields in the query result, for example:",(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},"Query result fields: ",(0,n.yg)("inlineCode",{parentName:"li"},"${error_count}"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"${service_name}"),", etc."),(0,n.yg)("li",{parentName:"ul"},"Basic variables: ",(0,n.yg)("inlineCode",{parentName:"li"},"${__alertname__}"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"${__severity__}"),", etc."))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Labels"),": Custom labels that will be attached to the alert when it is generated"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Annotations"),": Custom annotation information (supports environment variables) that will be rendered and attached to the alert"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Enable Alerting"),": Controls whether this threshold rule is active or not")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Once the threshold rules are configured, successfully triggered alerts will be displayed in the ","[Alert Center]","."),"\n",(0,n.yg)("strong",{parentName:"p"},"To send alert notifications via Email, WeChat, DingTalk, or Feishu, please go to ","[Notification Configuration]"," to set up the appropriate channels.")))}p.isMDXComponent=!0},68498:(e,t,a)=>{a.d(t,{A:()=>r});const r=a.p+"assets/images/alert-threshold-1-82dbbb56396a879b2ace555f51de5d60.png"},59209:(e,t,a)=>{a.d(t,{A:()=>r});const r=a.p+"assets/images/alert-threshold-2-34a36f6aeb08b718e92e4c5e5aae518a.png"},4384:(e,t,a)=>{a.d(t,{A:()=>r});const r=a.p+"assets/images/alert-threshold-3-a84e6904467479985f43f6d90540899e.png"},39359:(e,t,a)=>{a.d(t,{A:()=>r});const r=a.p+"assets/images/alert-threshold-4-1c32c6b64c6b9e9412c3d0c3dfae8bf4.png"},47029:(e,t,a)=>{a.d(t,{A:()=>r});const r=a.p+"assets/images/ssl_5-2448fbdd26d0152f94055729942541e6.png"}}]);