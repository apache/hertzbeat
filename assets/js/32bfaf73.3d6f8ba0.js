"use strict";(self.webpackChunkhertzbeat=self.webpackChunkhertzbeat||[]).push([[25811],{15680:(e,t,r)=>{r.d(t,{xA:()=>p,yg:()=>m});var a=r(96540);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),g=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},p=function(e){var t=g(e.components);return a.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=g(r),m=n,u=d["".concat(s,".").concat(m)]||d[m]||h[m]||i;return r?a.createElement(u,l(l({ref:t},p),{},{components:r})):a.createElement(u,l({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,l=new Array(i);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:n,l[1]=o;for(var g=2;g<i;g++)l[g]=r[g];return a.createElement.apply(null,l)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},5715:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>g});var a=r(58168),n=(r(96540),r(15680));const i={id:"alert_threshold",title:"Alarm Threshold Configuration",sidebar_label:"Alarm Threshold"},l=void 0,o={unversionedId:"help/alert_threshold",id:"help/alert_threshold",title:"Alarm Threshold Configuration",description:"Alarm Threshold are the core function of HertzBeat, users can configure the trigger conditions of the alarm through the threshold rules.",source:"@site/docs/help/alert_threshold.md",sourceDirName:"help",slug:"/help/alert_threshold",permalink:"/docs/help/alert_threshold",draft:!1,editUrl:"https://github.com/apache/hertzbeat/edit/master/home/docs/help/alert_threshold.md",tags:[],version:"current",frontMatter:{id:"alert_threshold",title:"Alarm Threshold Configuration",sidebar_label:"Alarm Threshold"},sidebar:"docs",previous:{title:"Alarm Center",permalink:"/docs/help/alarm_center"},next:{title:"Threshold Trigger Expression",permalink:"/docs/help/alert_threshold_expr"}},s={},g=[{value:"Real-time Threshold",id:"real-time-threshold",level:2},{value:"Creating Threshold Rules",id:"creating-threshold-rules",level:3},{value:"Scheduled Threshold",id:"scheduled-threshold",level:2},{value:"Syntax for Scheduled Threshold Expressions",id:"syntax-for-scheduled-threshold-expressions",level:3},{value:"Creating a Scheduled Threshold Rule",id:"creating-a-scheduled-threshold-rule",level:3}],p={toc:g};function h(e){let{components:t,...i}=e;return(0,n.yg)("wrapper",(0,a.A)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,n.yg)("admonition",{type:"tip"},(0,n.yg)("p",{parentName:"admonition"},"Alarm Threshold are the core function of ",(0,n.yg)("inlineCode",{parentName:"p"},"HertzBeat"),", users can configure the trigger conditions of the alarm through the threshold rules.",(0,n.yg)("br",{parentName:"p"}),"\n","Support real-time threshold and scheduled threshold, real-time threshold can directly trigger the alarm when monitoring data is collected, scheduled threshold supports PromQL and other expressions to calculate the trigger alarm within a specified time period.",(0,n.yg)("br",{parentName:"p"}),"\n","Support visual page configuration or more flexible expression rule configuration, support configuring trigger times, alarm levels, notification templates, associated specified monitoring and so on.")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"threshold",src:r(68498).A,width:"1955",height:"926"})),(0,n.yg)("h2",{id:"real-time-threshold"},"Real-time Threshold"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"Real-time threshold means that the alarm is triggered directly when the monitoring data is collected, which is suitable for scenarios with high real-time requirements.")),(0,n.yg)("h3",{id:"creating-threshold-rules"},"Creating Threshold Rules"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"HertzBeat Page -> Alerting -> Threshold -> New Threshold -> ReadTime Threshold Rule")),(0,n.yg)("p",null,"Configure the threshold, for example: Select the SSL certificate metric object, configure the alarm expression-triggered when the metric ",(0,n.yg)("inlineCode",{parentName:"p"},"expired")," is ",(0,n.yg)("inlineCode",{parentName:"p"},"true"),", that is, ",(0,n.yg)("inlineCode",{parentName:"p"},'equals(expired,"true")'),", set the alarm level notification template information, etc."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"HertzBeat",src:r(47029).A,width:"1937",height:"890"})),(0,n.yg)("p",null,"Configuration item details:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Rule Name"),"\uff1aUnique name defining this threshold rule"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Metric Object"),": Select the monitoring metric object for which we need to configure the threshold. For example: Under website monitoring type -> under the summary metric set -> responseTime metric."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Threshold Rule"),": Configure the alarm trigger rules for specific indicators, support graphical interface and expression rules. For expression environment variables and operators, see the page prompts. For detailed help on threshold expressions, see ",(0,n.yg)("a",{parentName:"li",href:"alert_threshold_expr"},"Threshold Expression Help"),"."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Associated Monitors"),"\uff1aApply this threshold rule to the specified monitoring object (support direct binding and label association). If not configured, it will be applied to all monitoring objects that meet this threshold type rule."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Level"),": The alert level triggered by the threshold, from low to high: warning, critical, emergency."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Trigger Count"),": Set how many times the threshold must be triggered before the alert is actually triggered."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Notification Template"),": The template for the notification message sent after the alert is triggered. Template variables are provided on the page. For example: ",(0,n.yg)("inlineCode",{parentName:"li"},"${app}.${metrics}.${metric} metric value is ${responseTime}, which is greater than 50 triggering the alert"),"."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Bind Label"),": Select the label we need to apply. If no label is selected, it will apply to all services corresponding to the set metric object."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Bing Annotation"),"\uff1aAdd annotation information to this threshold rule (the annotation content supports environment variables). When an alarm is generated, this annotation information will be rendered and attached to the alarm."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Enable Alert"),": Enable or disable this alert threshold configuration.")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"The threshold alert configuration is complete, and alerts that have been successfully triggered can be viewed in the ","[Alarm Center]","."),"\n",(0,n.yg)("strong",{parentName:"p"},"If you need to send alert notifications via email, WeChat, DingTalk, or Feishu, you can configure it in ","[Notification]",".")),(0,n.yg)("h2",{id:"scheduled-threshold"},"Scheduled Threshold"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},(0,n.yg)("strong",{parentName:"p"},"Scheduled Threshold Rules")," refer to rules where the system evaluates an expression (such as PromQL) at specified periodic intervals to determine whether monitoring data within a given time range meets alert conditions. These rules are suitable for scenarios requiring trend analysis or aggregated data evaluation, rather than immediate reactions to single real-time data points.")),(0,n.yg)("h3",{id:"syntax-for-scheduled-threshold-expressions"},"Syntax for Scheduled Threshold Expressions"),(0,n.yg)("p",null,"Scheduled threshold rules use a dedicated expression language based on ANTLR syntax, supporting PromQL-style queries. The syntax includes:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Query Expressions"),": Used to reference monitoring data, supporting PromQL style. For specific syntax, refer to the documentation of your configured time-series database."),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},'    cpu_usage\n    memory{\\__field\\__="field1"}\n'))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Comparison Expressions"),": Used to compare values against thresholds."),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},"    cpu_usage > 80\n    memory_usage >= 90.5\n    response_time < 1000\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Logical Expressions"),": Used to combine multiple conditions."),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},"    cpu_usage > 80 and memory_usage > 70\n    disk_usage > 90 or inode_usage > 85\n    cpu_usage > 80 unless maintenance_mode == 1\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Parenthesis Expressions"),": Used to control the order of evaluation."),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-text"},"    (cpu_usage > 80 or memory_usage > 90) and service_status == 1\n")))),(0,n.yg)("h3",{id:"creating-a-scheduled-threshold-rule"},"Creating a Scheduled Threshold Rule"),(0,n.yg)("p",null,"To configure a threshold rule, for example: define the expression ",(0,n.yg)("inlineCode",{parentName:"p"},'cpu_usage{instance="server1"} > 80')," for a group of CPU metrics, and trigger an alert when the expression is satisfied. You can also configure the evaluation interval, alert severity level, notification template, and more."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"threshold",src:r(59209).A,width:"2880",height:"1462"})),(0,n.yg)("p",null,"Configuration Items Explained:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Rule Name"),"\uff1aA unique identifier for the threshold rule."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Threshold Expression"),'\uff1aThe expression that defines the alert condition. It will be evaluated periodically according to the "Execution Interval". Supported elements include:',(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Query Identifiers"),": References to monitoring metrics (e.g., ",(0,n.yg)("inlineCode",{parentName:"li"},"cpu_usage"),", ",(0,n.yg)("inlineCode",{parentName:"li"},'memory{instance="server1"}'),")"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Comparison Operators"),": ",(0,n.yg)("inlineCode",{parentName:"li"},">"),", ",(0,n.yg)("inlineCode",{parentName:"li"},">="),", ",(0,n.yg)("inlineCode",{parentName:"li"},"<"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"<="),", ",(0,n.yg)("inlineCode",{parentName:"li"},"=="),", ",(0,n.yg)("inlineCode",{parentName:"li"},"!=")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Logical Operators"),": ",(0,n.yg)("inlineCode",{parentName:"li"},"and"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"or"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"unless")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Parentheses"),": Used for grouping and controlling evaluation order"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Numeric Literals"),": Threshold values (e.g., ",(0,n.yg)("inlineCode",{parentName:"li"},"80"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"90.5"),")"))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Execution Interval"),": The time interval (in seconds) at which the expression is evaluated. For example, ",(0,n.yg)("inlineCode",{parentName:"li"},"300")," means the rule is checked every 5 minutes."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Alert Level"),": The severity level triggered when the condition is met. Available levels: ",(0,n.yg)("inlineCode",{parentName:"li"},"warning"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"critical"),", ",(0,n.yg)("inlineCode",{parentName:"li"},"emergency"),"."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Trigger Count"),": The number of consecutive times the expression must evaluate to true before an alert is actually triggered."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Notification Content"),": The message template sent when an alert is triggered. Template variables are available on the configuration page."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Labels"),": Custom labels that will be attached to the alert when it is generated."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Additional Annotations"),": Custom annotation information (supports environment variables) that will be rendered and attached to the alert."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Enable Alerting"),": Controls whether this threshold rule is active or not.")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Once configured, successfully triggered alerts will be displayed in the ","[","Alert Center]."),"\n",(0,n.yg)("strong",{parentName:"p"},"To send alert notifications via Email, WeCom, DingTalk, or Feishu, please go to ","[","Notification Configuration] to set up the appropriate channels.")))}h.isMDXComponent=!0},68498:(e,t,r)=>{r.d(t,{A:()=>a});const a=r.p+"assets/images/alert-threshold-1-82dbbb56396a879b2ace555f51de5d60.png"},59209:(e,t,r)=>{r.d(t,{A:()=>a});const a=r.p+"assets/images/alert-threshold-2-34a36f6aeb08b718e92e4c5e5aae518a.png"},47029:(e,t,r)=>{r.d(t,{A:()=>a});const a=r.p+"assets/images/ssl_5-2448fbdd26d0152f94055729942541e6.png"}}]);