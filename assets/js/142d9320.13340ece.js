"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[47040],{52298(e,t,a){a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>n,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var r=a(44320),o=(a(37953),a(58860));const i={title:"GreptimeDB & HertzBeat, using the open source temporal database GreptimeDB to store metrics for the open source real-time monitoring HertzBeat",author:"tom",author_title:"tom",author_url:"https://github.com/tomsun28",tags:["opensource","practice"],keywords:["open source monitoring system","open source temporal database","HertzBeat","GreptimeDB"]},n=void 0,l={permalink:"/blog/2023/05/11/greptimedb-store",editUrl:"https://github.com/apache/hertzbeat/edit/master/home/blog/2023-05-11-greptimedb-store.md",source:"@site/blog/2023-05-11-greptimedb-store.md",title:"GreptimeDB & HertzBeat, using the open source temporal database GreptimeDB to store metrics for the open source real-time monitoring HertzBeat",description:"Using GreptimeDB, an open source temporal database, to store metrics for open source real-time monitoring HertzBeat",date:"2023-05-11T00:00:00.000Z",formattedDate:"May 11, 2023",tags:[{label:"opensource",permalink:"/blog/tags/opensource"},{label:"practice",permalink:"/blog/tags/practice"}],readingTime:4.575,hasTruncateMarker:!1,authors:[{name:"tom",title:"tom",url:"https://github.com/tomsun28"}],frontMatter:{title:"GreptimeDB & HertzBeat, using the open source temporal database GreptimeDB to store metrics for the open source real-time monitoring HertzBeat",author:"tom",author_title:"tom",author_url:"https://github.com/tomsun28",tags:["opensource","practice"],keywords:["open source monitoring system","open source temporal database","HertzBeat","GreptimeDB"]},prevItem:{title:"Open source monitoring HertzBeat v1.3.2 released, Easier to use",permalink:"/blog/2023/07/05/hertzbeat-v1.3.2"},nextItem:{title:"Open source real-time monitoring tool HertzBeat v1.3.1 released",permalink:"/blog/2023/05/09/hertzbeat-v1.3.1"}},p={authorsImageUrls:[void 0]},s=[{value:"Using GreptimeDB, an open source temporal database, to store metrics for open source real-time monitoring HertzBeat",id:"using-greptimedb-an-open-source-temporal-database-to-store-metrics-for-open-source-real-time-monitoring-hertzbeat",level:2},{value:"What is GreptimeDB?",id:"what-is-greptimedb",level:3},{value:"What is HertzBeat?",id:"what-is-hertzbeat",level:3},{value:"GreptimeDB &amp; HertzBeat",id:"greptimedb--hertzbeat",level:3},{value:"Installing and Deploying GreptimeDB",id:"installing-and-deploying-greptimedb",level:4},{value:"Installing and Deploying HertzBeat",id:"installing-and-deploying-hertzbeat",level:4},{value:"Configure to use GreptimeDB to store HertzBeat monitoring metrics metrics data",id:"configure-to-use-greptimedb-to-store-hertzbeat-monitoring-metrics-metrics-data",level:4},{value:"Observe the authentication effect",id:"observe-the-authentication-effect",level:4},{value:"Summary",id:"summary",level:2}],m={toc:s};function c({components:e,...t}){return(0,o.yg)("wrapper",(0,r.A)({},m,t,{components:e,mdxType:"MDXLayout"}),(0,o.yg)("h2",{id:"using-greptimedb-an-open-source-temporal-database-to-store-metrics-for-open-source-real-time-monitoring-hertzbeat"},"Using GreptimeDB, an open source temporal database, to store metrics for open source real-time monitoring HertzBeat"),(0,o.yg)("h3",{id:"what-is-greptimedb"},"What is GreptimeDB?"),(0,o.yg)("blockquote",null,(0,o.yg)("p",{parentName:"blockquote"},(0,o.yg)("a",{parentName:"p",href:"https://github.com/GreptimeTeam/greptimedb"},"GreptimeDB")," is an open source, distributed, cloud-native temporal database that fuses temporal data processing and analytics.")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Complete ecosystem, support a large number of open protocols, compatible with MySQL/PostreSQL/PromQL/OpenTSDB, etc., low learning cost, out-of-the-box."),(0,o.yg)("li",{parentName:"ul"},"Mixed load of timing and analytics, support for highly concurrent read/write; native support for PromQL, support for SQL/Python for powerful in-library analytics."),(0,o.yg)("li",{parentName:"ul"},"Efficient storage and computation, with object storage and high data compression rate to achieve ultra-low storage costs. Built-in data analytics solution to avoid replicating data to external data warehouses."),(0,o.yg)("li",{parentName:"ul"},"Distributed, Highly Reliable & Highly Available, easily scale each module independently with decoupled cloud-native architecture. Ensure data reliability and availability with configurable replicas and automated failover mechanisms.")),(0,o.yg)("p",null,"Cloud: ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("a",{parentName:"strong",href:"https://greptime.com/playground"},"GreptimePlay"))),(0,o.yg)("h3",{id:"what-is-hertzbeat"},"What is HertzBeat?"),(0,o.yg)("blockquote",null,(0,o.yg)("p",{parentName:"blockquote"},(0,o.yg)("a",{parentName:"p",href:"https://github.com/apache/hertzbeat"},"HertzBeat")," is an open source real-time monitoring and alerting tool with powerful customizable monitoring capabilities and no Agent required.")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"HertzBeat is an open source real-time monitoring and alerting tool with powerful customizable monitoring capabilities without the need for an agent. It integrates ",(0,o.yg)("strong",{parentName:"li"},"Monitoring+Alerting+Notification")," All in one, supports monitoring of application services, applications, databases, caching, operating systems, big data, middleware, web servers, cloud native, network, customization, etc., and notifies you of thresholds and alerts all in one step."),(0,o.yg)("li",{parentName:"ul"},"More liberalized threshold rules (calculation expressions), ",(0,o.yg)("inlineCode",{parentName:"li"},"Email")," ",(0,o.yg)("inlineCode",{parentName:"li"},"Discord")," ",(0,o.yg)("inlineCode",{parentName:"li"},"Slack")," ",(0,o.yg)("inlineCode",{parentName:"li"},"Telegram")," ",(0,o.yg)("inlineCode",{parentName:"li"},"Pinned")," ",(0,o.yg)("inlineCode",{parentName:"li"},"Dingtalk")," ",(0,o.yg)("inlineCode",{parentName:"li"},"WeChat")," ",(0,o.yg)("inlineCode",{parentName:"li"},"Flybook")," ",(0,o.yg)("inlineCode",{parentName:"li"},"SMS")," ",(0,o.yg)("inlineCode",{parentName:"li"},"Webhook")," and other ways to deliver in time."),(0,o.yg)("li",{parentName:"ul"},"Configurable ",(0,o.yg)("inlineCode",{parentName:"li"},"Http, Jmx, Ssh, Snmp, Jdbc, Prometheus")," and other protocol specifications, just configure the ",(0,o.yg)("inlineCode",{parentName:"li"},"YML")," monitoring template in the browser to use these protocols to customize the collection of desired metrics.")),(0,o.yg)("blockquote",null,(0,o.yg)("p",{parentName:"blockquote"},"With ",(0,o.yg)("inlineCode",{parentName:"p"},"HertzBeat"),"'s powerful customization, multi-type support, easy scalability and low coupling, we hope to help developers and small and medium-sized teams to quickly build their own monitoring system.")),(0,o.yg)("p",null,"Cloud: ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("a",{parentName:"strong",href:"https://console.tancloud.cn/"},"TanCloud"))),(0,o.yg)("h3",{id:"greptimedb--hertzbeat"},"GreptimeDB & HertzBeat"),(0,o.yg)("blockquote",null,(0,o.yg)("p",{parentName:"blockquote"},"In the following section, we will demonstrate step-by-step how HertzBeat can be combined with GreptimeDB as a storage to store the collected metrics data.")),(0,o.yg)("h4",{id:"installing-and-deploying-greptimedb"},"Installing and Deploying GreptimeDB"),(0,o.yg)("p",null,"You can refer to the ",(0,o.yg)("a",{parentName:"p",href:"https://docs.greptime.com/getting-started/overview#docker"},"official documentation")," for more details."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Docker installation of GreptimeDB"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-shell"},'$ docker run -p 4000-4004:4000-4004 \\\n    -p 4242:4242 -v "$(pwd)/greptimedb:/tmp/greptimedb" \\\n    --name greptime \\\n    greptime/greptimedb:0.2.0 standalone start \\\n    --http-addr 0.0.0.0.0:4000 \\\n    --rpc-addr 0.0.0.0:4001\n')),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},'-v "$(pwd)/greptimedb:/tmp/greptimedb"')," is the local persistent mount for the greptimeDB data directory, it is recommended to replace ",(0,o.yg)("inlineCode",{parentName:"li"},"$(pwd)/greptimedb")," with the actual local directory you want to specify for storage."))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Use ",(0,o.yg)("inlineCode",{parentName:"p"},"$ docker ps | grep greptime")," to see if GreptimeDB started successfully."))),(0,o.yg)("h4",{id:"installing-and-deploying-hertzbeat"},"Installing and Deploying HertzBeat"),(0,o.yg)("p",null,"See the ",(0,o.yg)("a",{parentName:"p",href:"https://hertzbeat.apache.org/zh-cn/docs/start/docker-deploy"},"official documentation")," for details."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Docker installs HertzBeat."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"$ docker run -d -p 1157:1157 \\\n    -e LANG=zh_CN.UTF-8 \\\n    -e TZ=Asia/Shanghai \\\n    -v /opt/data:/opt/hertzbeat/data \\\n    -v /opt/application.yml:/opt/hertzbeat/config/application.yml \\\n    --restart=always \\\n    --name hertzbeat apache/hertzbeat\n")),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"p"},"-v /opt/data:/opt/hertzbeat/data")," : (Optional, data persistence) Important \u26a0\ufe0f Mount the H2 database files to the local host to ensure that the data will not be lost due to the creation and deletion of the container")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"p"},"-v /opt/application.yml:/opt/hertzbeat/config/application.yml")," : Mount customized local configuration files to the container, i.e. use local configuration files to overwrite the container configuration files."),(0,o.yg)("p",{parentName:"li"},"Note that the \u26a0\ufe0f local mount configuration file ",(0,o.yg)("inlineCode",{parentName:"p"},"application.yml")," needs to exist in advance, and the full contents of the file can be found in the project repository ","[/script/application.yml]","(",(0,o.yg)("a",{parentName:"p",href:"https://github.com/apache/hertzbeat/raw/master/script/"},"https://github.com/apache/hertzbeat/raw/master/script/")," application.yml)")))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Go to ",(0,o.yg)("a",{parentName:"p",href:"http://ip:1157/"},"http://ip:1157/")," with the default account and password admin/hertzbeat to see if HertzBeat starts successfully."))),(0,o.yg)("h4",{id:"configure-to-use-greptimedb-to-store-hertzbeat-monitoring-metrics-metrics-data"},"Configure to use GreptimeDB to store HertzBeat monitoring metrics metrics data"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Modify the HertzBeat configuration file."),(0,o.yg)("p",{parentName:"li"},"Modify the locally mounted HertzBeat configuration file ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/apache/hertzbeat/raw/master/script/application.yml"},"application.yml"),", in package mode modify `hertzbeat/ config/application.yml"),(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Modify the ",(0,o.yg)("inlineCode",{parentName:"strong"},"warehouse.store.jpa.enabled")," parameter in there to ",(0,o.yg)("inlineCode",{parentName:"strong"},"false"),", configure the ",(0,o.yg)("inlineCode",{parentName:"strong"},"warehouse.store.greptime")," datasource parameter in there, the URL account password, and enable ",(0,o.yg)("inlineCode",{parentName:"strong"},"enabled")," to ",(0,o.yg)("inlineCode",{parentName:"strong"},"true")),"."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-yaml"},"warehouse:\n  store:\n    jpa:\n      enabled: false\n    greptime:\n      enabled: true\n      endpoint: localhost:4001\n"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Restart HertzBeat."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"docker restart hertzbeat\n")))),(0,o.yg)("h4",{id:"observe-the-authentication-effect"},"Observe the authentication effect"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"visit HertzBeat in your browser ",(0,o.yg)("a",{parentName:"li",href:"http://ip:1157/"},"http://ip:1157/")," default account password admin/hertzbeat"),(0,o.yg)("li",{parentName:"ol"},"Use HertzBeat to add application monitors, such as website monitors, Linux monitors, Mysql monitors, and so on."),(0,o.yg)("li",{parentName:"ol"},"After monitoring and collecting several cycles, check whether GreptimeDB database stores the metrics data and whether HertzBeat metrics data graph data is displayed normally.")),(0,o.yg)("p",null,"Here's the picture: !"),(0,o.yg)("p",null,(0,o.yg)("img",{alt:"HertzBeat",src:a(80102).A,width:"4064",height:"2166"})),(0,o.yg)("p",null,(0,o.yg)("img",{alt:"HertzBeat",src:a(77661).A,width:"4064",height:"2166"})),(0,o.yg)("p",null,(0,o.yg)("img",{alt:"HertzBeat",src:a(56532).A,width:"2764",height:"1664"})),(0,o.yg)("h2",{id:"summary"},"Summary"),(0,o.yg)("p",null,"This article took us to experience how to use the open source time-series database GreptimeDB to store the metrics data of the open source real-time monitoring HertzBeat, in general, the two open source products is very simple to get started, the key is that if it is too much trouble do not want to deploy both of them still have cloud services \ud83d\ude02 let you toss.\nAs one of the developers of the feature ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/apache/hertzbeat/pull/834"},"HertzBeat supports GreptimeDB"),", in the actual adaptation process, GreptimeDB's silky-smooth native SDK and relational database-like SQL, let us from other GreptimeDB native SDK and relational database-like SQL make it very easy to switch from other time-series databases like ",(0,o.yg)("inlineCode",{parentName:"p"},"TDengine, IotDB, InfluxDB")," to GreptimeDB, and the experience is very smooth."),(0,o.yg)("p",null,"GreptimeDB Github: ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/GreptimeTeam/greptimedb"},"https://github.com/GreptimeTeam/greptimedb"),"\nHertzBeat Github: ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/apache/hertzbeat"},"https://github.com/apache/hertzbeat")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Finally, you are welcome to be more understanding, more use, more comments, more ISSUE, more PR, more Star support these two did not come out for a long time hope to get care of open source cattle are not afraid of difficulties a small star oh! Do open source, we are sincere, love \ud83d\udc97")),(0,o.yg)("p",null,"Thanks to the contributors of this feature ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/apache/hertzbeat/pull/834"},"HertzBeat support GreptimeDB")," @zqr10159, @fengjiachun, @killme2008, @tomsun28"))}c.isMDXComponent=!0},56532(e,t,a){a.d(t,{A:()=>r});const r=a.p+"assets/images/greptime-3-7640c67312e8c1db060284867b78d65e.png"},58860(e,t,a){a.d(t,{xA:()=>m,yg:()=>u});var r=a(37953);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach(function(t){o(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function l(e,t){if(null==e)return{};var a,r,o=function(e,t){if(null==e)return{};var a,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var p=r.createContext({}),s=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):n(n({},t),e)),a},m=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef(function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),g=s(a),u=o,d=g["".concat(p,".").concat(u)]||g[u]||c[u]||i;return a?r.createElement(d,n(n({ref:t},m),{},{components:a})):r.createElement(d,n({ref:t},m))});function u(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,n=new Array(i);n[0]=g;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,n[1]=l;for(var s=2;s<i;s++)n[s]=a[s];return r.createElement.apply(null,n)}return r.createElement.apply(null,a)}g.displayName="MDXCreateElement"},77661(e,t,a){a.d(t,{A:()=>r});const r=a.p+"assets/images/greptime-2-264d43273a7cfe3bda1112db315c6f1c.png"},80102(e,t,a){a.d(t,{A:()=>r});const r=a.p+"assets/images/greptime-1-d2ba51f5163374602e1a0643db6edbcc.png"}}]);