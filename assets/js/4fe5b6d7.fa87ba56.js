"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[29372],{45906:(e,t,a)=>{a.d(t,{R:()=>o,x:()=>i});var n=a(30758);const s={},r=n.createContext(s);function o(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(r.Provider,{value:t},e.children)}},64053:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"start/postgresql-change","title":"Use PostgreSQL Replace H2 Database to Store Metadata(Recommended)","description":"PostgreSQL is a RDBMS emphasizing extensibility and SQL compliance. In addition to default built-in H2 database, Apache HertzBeat\u2122 allow you to use PostgreSQL to store structured relational data such as monitoring information, alarm information and configuration information.","source":"@site/docs/start/postgresql-change.md","sourceDirName":"start","slug":"/start/postgresql-change","permalink":"/docs/next/start/postgresql-change","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hertzbeat/edit/master/home/docs/start/postgresql-change.md","tags":[],"version":"current","frontMatter":{"id":"postgresql-change","title":"Use PostgreSQL Replace H2 Database to Store Metadata(Recommended)","sidebar_label":"Meta Store PostgreSQL (Recommended)"},"sidebar":"docs","previous":{"title":"Metrics Store InfluxDB","permalink":"/docs/next/start/influxdb-init"},"next":{"title":"Meta Store MYSQL","permalink":"/docs/next/start/mysql-change"}}');var s=a(86070),r=a(45906);const o={id:"postgresql-change",title:"Use PostgreSQL Replace H2 Database to Store Metadata(Recommended)",sidebar_label:"Meta Store PostgreSQL (Recommended)"},i=void 0,l={},c=[{value:"Install PostgreSQL via Docker",id:"install-postgresql-via-docker",level:3},{value:"Database creation",id:"database-creation",level:3},{value:"Modify hertzbeat&#39;s configuration file application.yml and switch data source",id:"modify-hertzbeats-configuration-file-applicationyml-and-switch-data-source",level:3}];function d(e){const t={a:"a",blockquote:"blockquote",br:"br",code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"PostgreSQL is a RDBMS emphasizing extensibility and SQL compliance. In addition to default built-in H2 database, Apache HertzBeat\u2122 allow you to use PostgreSQL to store structured relational data such as monitoring information, alarm information and configuration information."}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"If you have the PostgreSQL environment, can be directly to database creation step."}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"install-postgresql-via-docker",children:"Install PostgreSQL via Docker"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Download and install the Docker environment\nDocker tools download refer to ",(0,s.jsx)(t.a,{href:"https://docs.docker.com/get-docker/",children:"Docker official document"}),"\u3002\nAfter the installation you can check if the Docker version normally output at the terminal."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"$ docker -v\nDocker version 20.10.12, build e91ed57\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Install PostgreSQL with Docker"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"docker run -d --name postgresql -p 5432:5432 -e POSTGRES_USER=root -e POSTGRES_PASSWORD=123456 -e TZ=Asia/Shanghai postgres:15       \n"})}),"\n",(0,s.jsxs)(t.p,{children:["use",(0,s.jsx)(t.code,{children:"$ docker ps"}),"to check if the database started successfully"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"database-creation",children:"Database creation"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Enter postgreSQL or use the client to connect postgreSQL service"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"su - postgres\npsql\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Create database named hertzbeat"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE DATABASE hertzbeat;\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Check if hertzbeat database has been successfully created"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"SELECT * FROM pg_database where datname='hertzbeat';\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"modify-hertzbeats-configuration-file-applicationyml-and-switch-data-source",children:"Modify hertzbeat's configuration file application.yml and switch data source"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Configure HertzBeat's configuration file\nModify ",(0,s.jsx)(t.code,{children:"hertzbeat/config/application.yml"})," configuration file\nNote\u26a0\ufe0fThe docker container way need to mount application.yml file locally, while you can use installation package way to unzip and modify ",(0,s.jsx)(t.code,{children:"hertzbeat/config/application.yml"}),(0,s.jsx)(t.br,{}),"\n","Replace ",(0,s.jsx)(t.code,{children:"spring.database"})," data source parameters, URL account and password."]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"spring:\n  datasource:\n    driver-class-name: org.h2.Driver\n    username: sa\n    password: 123456\n    url: jdbc:h2:./data/hertzbeat;MODE=MYSQL\n    hikari:\n      max-lifetime: 120000\n\n  jpa:\n    show-sql: false\n    database-platform: org.eclipse.persistence.platform.database.MySQLPlatform\n    database: h2\n    properties:\n      eclipselink:\n        logging:\n          level: SEVERE\n"})}),"\n",(0,s.jsx)(t.p,{children:"Specific replacement parameters are as follows and you need to configure account, ip, port according to the postgresql environment:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"spring:\n  datasource:\n    driver-class-name: org.postgresql.Driver\n    username: root\n    password: 123456\n    url: jdbc:postgresql://postgresql:5432/hertzbeat\n    hikari:\n      max-lifetime: 120000\n  jpa:\n    show-sql: false\n    database-platform: org.eclipse.persistence.platform.database.PostgreSQLPlatform\n    database: postgresql\n    properties:\n      eclipselink:\n        logging:\n          level: SEVERE\n"})}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["Note: The above applies to the method of downloading and installing the package. For local data source switching, simply complete the ",(0,s.jsx)(t.a,{href:"./postgresql-change#database-creation",children:"Database creation"})," and modify the configuration in ",(0,s.jsx)(t.code,{children:"hertzbeat-startup/src/main/resources/application.yml"}),"."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsxs)(t.strong,{children:["Start HertzBeat  visit ",(0,s.jsx)(t.a,{href:"http://ip:1157/",children:"http://ip:1157/"})," on the browser  You can use HertzBeat monitoring alarm, default account and password are admin/hertzbeat"]})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);