"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[98050],{4655:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=a(44320),n=(a(37953),a(58860));const i={id:"greptime-init",title:"Use Time Series Database Greptime to Store Metrics Data (Recommended)",sidebar_label:"Metrics Store Greptime (Recommended)"},o=void 0,l={unversionedId:"start/greptime-init",id:"start/greptime-init",title:"Use Time Series Database Greptime to Store Metrics Data (Recommended)",description:"Apache HertzBeat's historical data storage relies on the time series database, you can choose one of them to install and initialize, or not to install (note \u26a0\ufe0f but it is strongly recommended to configure in the production environment)",source:"@site/docs/start/greptime-init.md",sourceDirName:"start",slug:"/start/greptime-init",permalink:"/docs/start/greptime-init",draft:!1,editUrl:"https://github.com/apache/hertzbeat/edit/master/home/docs/start/greptime-init.md",tags:[],version:"current",frontMatter:{id:"greptime-init",title:"Use Time Series Database Greptime to Store Metrics Data (Recommended)",sidebar_label:"Metrics Store Greptime (Recommended)"},sidebar:"docs",previous:{title:"Advanced Params Config",permalink:"/docs/start/custom-config"},next:{title:"Metrics Store VictoriaMetrics (Recommended)",permalink:"/docs/start/victoria-metrics-init"}},c={},p=[{value:"Install GreptimeDvia Docker",id:"install-greptimedvia-docker",level:3},{value:"Configure the database connection in hertzbeat <code>application.yml</code> configuration file",id:"configure-the-database-connection-in-hertzbeat-applicationyml-configuration-file",level:3},{value:"FAQ",id:"faq",level:3}],s={toc:p},d="wrapper";function m({components:e,...t}){return(0,n.yg)(d,(0,r.A)({},s,t,{components:e,mdxType:"MDXLayout"}),(0,n.yg)("p",null,"Apache HertzBeat's historical data storage relies on the time series database, you can choose one of them to install and initialize, or not to install (note \u26a0\ufe0f but it is strongly recommended to configure in the production environment)"),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"It is recommended to use Greptime as metrics storage.")),(0,n.yg)("p",null,(0,n.yg)("a",{parentName:"p",href:"https://github.com/GreptimeTeam/greptimedb"},"Greptime")," is an Open-source, cloud-native, unified observability database for metrics, logs and traces, supporting SQL/PromQL/Streaming."),(0,n.yg)("p",null,"It's designed to work on infrastructure of the cloud era, and users benefit from its elasticity and commodity storage."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"\u26a0\ufe0f If you do not configure a time series database, only the last hour of historical data is retained.")),(0,n.yg)("h3",{id:"install-greptimedvia-docker"},"Install GreptimeDvia Docker"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Download and install Docker environment\nDocker tools download refer to ",(0,n.yg)("a",{parentName:"p",href:"https://docs.docker.com/get-docker/"},"Docker official document"),".\nAfter the installation you can check if the Docker version normally output at the terminal."),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"$ docker -v\nDocker version 20.10.12, build e91ed57\n"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Install Greptime with Docker"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'$ docker run -d -p 127.0.0.1:4000-4003:4000-4003 \\\nv "$(pwd)/greptimedb:/tmp/greptimedb" \\\n--name greptime \\\ngreptime/greptimedb:latest standalone start \\\n--http-addr 0.0.0.0:4000 \\\n--rpc-addr 0.0.0.0:4001 \\\n--mysql-addr 0.0.0.0:4002 \\\n--postgres-addr 0.0.0.0:4003\n')))),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},'-v "$(pwd)/greptimedb:/tmp/greptimedb"')," is local persistent mount of greptime data directory. ",(0,n.yg)("inlineCode",{parentName:"p"},"$(pwd)/greptimedb")," should be replaced with the actual local directory, default is the ",(0,n.yg)("inlineCode",{parentName:"p"},"greptimedb")," directory under the current directory.\nuse",(0,n.yg)("inlineCode",{parentName:"p"},"$ docker ps")," to check if the database started successfully"),(0,n.yg)("h3",{id:"configure-the-database-connection-in-hertzbeat-applicationyml-configuration-file"},"Configure the database connection in hertzbeat ",(0,n.yg)("inlineCode",{parentName:"h3"},"application.yml")," configuration file"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Configure HertzBeat's configuration file\nModify ",(0,n.yg)("inlineCode",{parentName:"p"},"hertzbeat/config/application.yml")," configuration file ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/apache/hertzbeat/raw/master/script/application.yml"},"/script/application.yml"),"\nNote\u26a0\ufe0fThe docker container way need to mount application.yml file locally, while you can use installation package way to unzip and modify ",(0,n.yg)("inlineCode",{parentName:"p"},"hertzbeat/config/application.yml"),"\nReplace ",(0,n.yg)("inlineCode",{parentName:"p"},"warehouse.store.greptime")," data source parameters, URL account and password."),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},"warehouse:\n   store:\n      jpa:\n         enabled: false\n      greptime:\n         enabled: true\n         grpc-endpoints: localhost:4001\n         http-endpoint: http://localhost:4000\n         database: public\n         username: greptime\n         password: greptime\n")),(0,n.yg)("p",{parentName:"li"},"The default database is ",(0,n.yg)("inlineCode",{parentName:"p"},"public"),", if you specify another database name, you need to create it in ",(0,n.yg)("inlineCode",{parentName:"p"},"greptimeDB")," in advance.",(0,n.yg)("br",{parentName:"p"}),"\n","eg: Create a database named ",(0,n.yg)("inlineCode",{parentName:"p"},"hertzbeat")," with a validity period of 90 days SQL: ",(0,n.yg)("inlineCode",{parentName:"p"},"CREATE DATABASE IF NOT EXISTS hertzbeat WITH(ttl='90d')"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Restart HertzBeat"))),(0,n.yg)("h3",{id:"faq"},"FAQ"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Do both the time series databases need to be configured? Can they both be used?"),(0,n.yg)("blockquote",{parentName:"li"},(0,n.yg)("p",{parentName:"blockquote"},"You don't need to configure all of them, you can choose one of them. Use the enable parameter to control whether it is used or not. You can also install and configure neither, which only affects the historical chart data.")))))}m.isMDXComponent=!0},58860:(e,t,a)=>{a.d(t,{xA:()=>s,yg:()=>g});var r=a(37953);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach(function(t){n(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=r.createContext({}),p=function(e){var t=r.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},s=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef(function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=p(a),u=n,g=d["".concat(c,".").concat(u)]||d[u]||m[u]||i;return a?r.createElement(g,o(o({ref:t},s),{},{components:a})):r.createElement(g,o({ref:t},s))});function g(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[d]="string"==typeof e?e:n,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);