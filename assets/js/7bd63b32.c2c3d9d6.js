"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[24122],{76420(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"help/tdengine_promql","title":"Monitoring TDengine-PromQL","description":"Use Prometheus PromQL to query general metric data from the Prometheus server to monitor TDengine. This solution is","source":"@site/versioned_docs/version-1.8.0/help/tdengine_promql.md","sourceDirName":"help","slug":"/help/tdengine_promql","permalink":"/docs/help/tdengine_promql","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hertzbeat/edit/master/home/versioned_docs/version-1.8.0/help/tdengine_promql.md","tags":[],"version":"1.8.0","frontMatter":{"id":"tdengine_promql","title":"Monitoring TDengine-PromQL","sidebar_label":"TDengine-PromQL","keywords":["Open Source Monitoring System","Open Source Middleware Monitoring","TDengine Monitoring","TDengine-PromQL Monitoring"]},"sidebar":"docs","previous":{"title":"InfluxDB-PromQL","permalink":"/docs/help/influxdb_promql"},"next":{"title":"Status Page","permalink":"/docs/help/status"}}');var r=n(86070),i=n(60056);const d={id:"tdengine_promql",title:"Monitoring TDengine-PromQL",sidebar_label:"TDengine-PromQL",keywords:["Open Source Monitoring System","Open Source Middleware Monitoring","TDengine Monitoring","TDengine-PromQL Monitoring"]},o=void 0,l={},c=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"Configuration parameters",id:"configuration-parameters",level:3},{value:"Collection indicators",id:"collection-indicators",level:3},{value:"Indicator set: Basic information indicators",id:"indicator-set-basic-information-indicators",level:4},{value:"Indicator set: Number of nodes indicator",id:"indicator-set-number-of-nodes-indicator",level:4},{value:"Indicator set: Database and table statistics",id:"indicator-set-database-and-table-statistics",level:3},{value:"Indicator set: Dnode information",id:"indicator-set-dnode-information",level:3},{value:"Indicator set: taosadapter related",id:"indicator-set-taosadapter-related",level:3},{value:"Other TDengine monitoring methods supported by HertzBeat",id:"other-tdengine-monitoring-methods-supported-by-hertzbeat",level:3}];function a(e){const t={a:"a",blockquote:"blockquote",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:"Use Prometheus PromQL to query general metric data from the Prometheus server to monitor TDengine. This solution is\nsuitable for situations where Prometheus is already monitoring TDengine and you need to retrieve TDengine monitoring\ndata from the Prometheus server."}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Deploy TDengine;"}),"\n",(0,r.jsxs)(t.li,{children:["Deploy taosKeeper; note that installing the official TDengine installation package will automatically install\ntaosKeeper. For details, please refer to: ",(0,r.jsx)(t.a,{href:"https://docs.taosdata.com/reference/components/taoskeeper/",children:"taosKeeper"}),";"]}),"\n",(0,r.jsx)(t.li,{children:"Collect monitoring metrics exposed by TDengine taosKeeper through prometheus;"}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"configuration-parameters",children:"Configuration parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter Name"}),(0,r.jsx)(t.th,{children:"Parameter Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Monitoring Host"}),(0,r.jsx)(t.td,{children:"IP, IPv6, or domain name of the target being monitored. Note \u26a0\ufe0f: Do not include protocol header (e.g., https://, http://)."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Monitoring name"}),(0,r.jsx)(t.td,{children:"Name to identify this monitoring, ensuring uniqueness of names."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Port"}),(0,r.jsx)(t.td,{children:"Prometheus API port, default: 9090."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Relative path"}),(0,r.jsx)(t.td,{children:"Relative path of Prometheus to query PromQL, default: /api/v1/query"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Request mode"}),(0,r.jsx)(t.td,{children:"Set the request method for API calls: GET, POST, PUT, DELETE, default: GET"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Enable HTTPS"}),(0,r.jsx)(t.td,{children:"Whether to access the website via HTTPS, note \u26a0\ufe0f: enabling HTTPS generally requires changing the corresponding port to 443"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Username"}),(0,r.jsx)(t.td,{children:"Username for Basic or Digest authentication when accessing the API."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Password"}),(0,r.jsx)(t.td,{children:"Password for Basic or Digest authentication when accessing the API."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Content-Type"}),(0,r.jsx)(t.td,{children:"Resource type when carrying BODY request data."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Request BODY"}),(0,r.jsx)(t.td,{children:"Set the BODY request data, effective for PUT and POST request methods."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Collection interval"}),(0,r.jsx)(t.td,{children:"Interval for periodic data collection in seconds, the minimum interval that can be set is 30 seconds"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Description remarks"}),(0,r.jsx)(t.td,{children:"Additional remarks and descriptions for this monitoring. Users can add notes here."})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"collection-indicators",children:"Collection indicators"}),"\n",(0,r.jsx)(t.h4,{id:"indicator-set-basic-information-indicators",children:"Indicator set: Basic information indicators"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Indicator name"}),(0,r.jsx)(t.th,{children:"indicator unit"}),(0,r.jsx)(t.th,{children:"Indicators help describe"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_first_ep"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"first endpoint"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_version"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Version Information"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_master_uptime"}),(0,r.jsx)(t.td,{children:"day"}),(0,r.jsx)(t.td,{children:"Master node runtime"})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"indicator-set-number-of-nodes-indicator",children:"Indicator set: Number of nodes indicator"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Indicator name"}),(0,r.jsx)(t.th,{children:"indicator unit"}),(0,r.jsx)(t.th,{children:"Indicators help describe"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_dnodes_total"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Total number of dnodes"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_dnodes_alive"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Number of surviving dnodes"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_mnodes_total"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Total number of mnodes"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_mnodes_alive"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Number of surviving mnodes"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_vgroups_total"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Total number of virtual groups"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_vgroups_alive"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Number of surviving virtual groups"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_vnodes_total"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Total number of virtual nodes"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_vnodes_alive"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Number of surviving virtual nodes"})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"indicator-set-database-and-table-statistics",children:"Indicator set: Database and table statistics"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Indicator name"}),(0,r.jsx)(t.th,{children:"indicator unit"}),(0,r.jsx)(t.th,{children:"Indicators help describe"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_dbs_total"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Total number of databases"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_tbs_total"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Total number of tables"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_cluster_info_connections_total"}),(0,r.jsx)(t.td,{children:"day"}),(0,r.jsx)(t.td,{children:"total number of connections"})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"indicator-set-dnode-information",children:"Indicator set: Dnode information"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Indicator name"}),(0,r.jsx)(t.th,{children:"indicator unit"}),(0,r.jsx)(t.th,{children:"Indicators help describe"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_d_info_status"}),(0,r.jsx)(t.td,{children:"Ready indicates normal, offline indicates offline, and unknown indicates unknown."}),(0,r.jsx)(t.td,{children:"dnode status"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_uptime"}),(0,r.jsx)(t.td,{children:"s"}),(0,r.jsx)(t.td,{children:"The startup time of this dnode"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_cpu_engine"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"The percentage of CPU used by the process of this dnode."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_cpu_system"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"The percentage of CPU used by the system of the node where the dnode is located."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_mem_engine"}),(0,r.jsx)(t.td,{children:"KB"}),(0,r.jsx)(t.td,{children:"Memory used by the process of this dnode"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_mem_system"}),(0,r.jsx)(t.td,{children:"KB"}),(0,r.jsx)(t.td,{children:"The memory used by the system of the node where the dnode is located."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_disk_total"}),(0,r.jsx)(t.td,{children:"Byte"}),(0,r.jsx)(t.td,{children:"The total disk capacity of the node where the dnode is located."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_disk_used"}),(0,r.jsx)(t.td,{children:"Byte"}),(0,r.jsx)(t.td,{children:"The amount of disk space used on the node where the dnode is located."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_io_write_disk"}),(0,r.jsx)(t.td,{children:"Bytes per second"}),(0,r.jsx)(t.td,{children:"The disk IO write rate of the node where the dnode is located."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_dnodes_info_io_read_disk"}),(0,r.jsx)(t.td,{children:"Bytes per second"}),(0,r.jsx)(t.td,{children:"The disk IO read rate of the node where the dnode is located."})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"indicator-set-taosadapter-related",children:"Indicator set: taosadapter related"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Indicator name"}),(0,r.jsx)(t.th,{children:"indicator unit"}),(0,r.jsx)(t.th,{children:"Indicators help describe"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"total_requests_for_adapter_transfers"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Total number of requests"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_adapter_requests_success"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Number of successful requests"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_adapter_requests_fail"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Number of failed requests"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"taos_adapter_requests_query"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"Number of query requests"})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"other-tdengine-monitoring-methods-supported-by-hertzbeat",children:"Other TDengine monitoring methods supported by HertzBeat"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["Through the monitoring metrics exposed by taosKeeper, you can refer to ",(0,r.jsx)(t.a,{href:"prometheus",children:"Prometheus Task"})," to configure\nPrometheus collection tasks for monitoring TDengine."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},60056(e,t,n){n.d(t,{R:()=>d,x:()=>o});var s=n(30758);const r={},i=s.createContext(r);function d(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);