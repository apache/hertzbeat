"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[54451],{45906:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>d});var r=t(30758);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}},80230:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"help/docker","title":"Monitor\uff1aDocker Monitor","description":"Collect and monitor general performance Metrics of Docker containers.","source":"@site/versioned_docs/version-1.7.x/help/docker.md","sourceDirName":"help","slug":"/help/docker","permalink":"/docs/1.7.x/help/docker","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hertzbeat/edit/master/home/versioned_docs/version-1.7.x/help/docker.md","tags":[],"version":"1.7.x","frontMatter":{"id":"docker","title":"Monitor\uff1aDocker Monitor","sidebar_label":"Docker Monitor","keywords":["open source monitoring tool","open source docker monitoring tool","monitoring docker metrics"]},"sidebar":"docs","previous":{"title":"Jetty Web Server","permalink":"/docs/1.7.x/help/jetty"},"next":{"title":"Kubernetes Monitor","permalink":"/docs/1.7.x/help/kubernetes"}}');var i=t(86070),s=t(45906);const o={id:"docker",title:"Monitor\uff1aDocker Monitor",sidebar_label:"Docker Monitor",keywords:["open source monitoring tool","open source docker monitoring tool","monitoring docker metrics"]},d=void 0,c={},l=[{value:"Pre-monitoring operations",id:"pre-monitoring-operations",level:2},{value:"Configuration parameters",id:"configuration-parameters",level:3},{value:"Collect metrics",id:"collect-metrics",level:3},{value:"Metric collection: system",id:"metric-collection-system",level:4},{value:"Metric collection: containers",id:"metric-collection-containers",level:4},{value:"Metrics collection: stats",id:"metrics-collection-stats",level:4}];function h(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Collect and monitor general performance Metrics of Docker containers."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"pre-monitoring-operations",children:"Pre-monitoring operations"}),"\n",(0,i.jsxs)(n.p,{children:["If you want to monitor the container information in ",(0,i.jsx)(n.code,{children:"Docker"}),", you need to open the port according to the following steps, so that the collection request can obtain the corresponding information."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"1. Edit the docker.server file:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"vi /usr/lib/systemd/system/docker.service\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Find the ",(0,i.jsx)(n.strong,{children:"[Service]"})," node, modify the ExecStart property, and add ",(0,i.jsx)(n.code,{children:"-H tcp://0.0.0.0:2375"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock -H tcp://0.0.0.0:2375\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This is equivalent to the ",(0,i.jsx)(n.strong,{children:"2375"})," port that is open to the outside world. Of course, it can be modified to other ports according to your own situation."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"2. Reload the Docker configuration to take effect:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"systemctl daemon-reload\nsystemctl restart docker\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Note: Remember to open the ",(0,i.jsx)(n.code,{children:"2375"})," port number in the server console."]})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"3. If the above method does not work:"})}),"\n",(0,i.jsxs)(n.p,{children:["Open the ",(0,i.jsx)(n.code,{children:"2375"})," port number inside the server."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"firewall-cmd --zone=public --add-port=2375/tcp --permanent\nfirewall-cmd --reload\n"})}),"\n",(0,i.jsx)(n.h3,{id:"configuration-parameters",children:"Configuration parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter name"}),(0,i.jsx)(n.th,{children:"Parameter help description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Monitor Host"}),(0,i.jsx)(n.td,{children:"Monitored peer IPV4, IPV6 or domain name. Note \u26a0\ufe0f without protocol headers (eg: https://, http://)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Monitor Name"}),(0,i.jsx)(n.td,{children:"Identifies the name of this monitor. The name needs to be unique."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Port"}),(0,i.jsx)(n.td,{children:"The port provided by the database externally, the default is 2375."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Query Timeout"}),(0,i.jsx)(n.td,{children:"Set the timeout when getting the Docker server API interface, in ms, the default is 3000 ms."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Container Name"}),(0,i.jsx)(n.td,{children:"Generally monitors all running container information."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"username"}),(0,i.jsx)(n.td,{children:"connection username, optional"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"password"}),(0,i.jsx)(n.td,{children:"connection password, optional"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"URL"}),(0,i.jsx)(n.td,{children:"Database connection URL, optional, if configured, the parameters such as database name, username and password in the URL will override the parameters configured above"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Collection Interval"}),(0,i.jsx)(n.td,{children:"Monitor periodical collection data interval, in seconds, the minimum interval that can be set is 30 seconds"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Whether to detect"}),(0,i.jsx)(n.td,{children:"Whether to detect and check the availability of monitoring before adding monitoring, and then continue to add and modify operations if the detection is successful"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Description Remarks"}),(0,i.jsx)(n.td,{children:"More remarks that identify and describe this monitoring, users can remark information here"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"collect-metrics",children:"Collect metrics"}),"\n",(0,i.jsx)(n.h4,{id:"metric-collection-system",children:"Metric collection: system"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric Name"}),(0,i.jsx)(n.th,{children:"Metric Unit"}),(0,i.jsx)(n.th,{children:"Metric Help Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Name"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Server Name"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"version"}),(0,i.jsx)(n.td,{children:"none"}),(0,i.jsx)(n.td,{children:"docker version number"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"os"}),(0,i.jsx)(n.td,{children:"none"}),(0,i.jsx)(n.td,{children:"server version eg: linux x86_64"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"root_dir"}),(0,i.jsx)(n.td,{children:"none"}),(0,i.jsx)(n.td,{children:"docker folder directory eg: /var/lib/docker"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"containers"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Total number of containers (running + not running)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"containers_running"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Number of running containers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"containers_paused"}),(0,i.jsx)(n.td,{children:"none"}),(0,i.jsx)(n.td,{children:"number of containers in pause"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"images"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"The total number of container images."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ncpu"}),(0,i.jsx)(n.td,{children:"none"}),(0,i.jsx)(n.td,{children:"ncpu"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"mem_total"}),(0,i.jsx)(n.td,{children:"MB"}),(0,i.jsx)(n.td,{children:"Total size of memory used"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"system_time"}),(0,i.jsx)(n.td,{children:"none"}),(0,i.jsx)(n.td,{children:"system time"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"metric-collection-containers",children:"Metric collection: containers"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric Name"}),(0,i.jsx)(n.th,{children:"Metric Unit"}),(0,i.jsx)(n.th,{children:"Metric Help Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"id"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"The ID of the container in Docker"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"name"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"The container name in the Docker container"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"image"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Image used by the Docker container"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"command"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Default startup command in Docker"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"state"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"The running state of the container in Docker"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"status"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Update time in Docker container"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"metrics-collection-stats",children:"Metrics collection: stats"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric Name"}),(0,i.jsx)(n.th,{children:"Metric Unit"}),(0,i.jsx)(n.th,{children:"Metric Help Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"name"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"The name in the Docker container"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"available_memory"}),(0,i.jsx)(n.td,{children:"MB"}),(0,i.jsx)(n.td,{children:"The amount of memory that the Docker container can utilize"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"used_memory"}),(0,i.jsx)(n.td,{children:"MB"}),(0,i.jsx)(n.td,{children:"The amount of memory already used by the Docker container"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"memory_usage"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Memory usage of the Docker container"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"cpu_delta"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"The number of CPUs already used by the Docker container"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"number_cpus"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"The number of CPUs that the Docker container can use"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"cpu_usage"}),(0,i.jsx)(n.td,{children:"None"}),(0,i.jsx)(n.td,{children:"Docker container CPU usage"})]})]})]})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);