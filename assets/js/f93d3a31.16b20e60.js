"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[94453],{30316(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var o=n(44320),a=(n(37953),n(58860));const r={id:"issue",title:"Common issues",sidebar_label:"Common issues"},i=void 0,s={unversionedId:"help/issue",id:"help/issue",title:"Common issues",description:"Monitoring common issues",source:"@site/docs/help/issue.md",sourceDirName:"help",slug:"/help/issue",permalink:"/docs/help/issue",draft:!1,editUrl:"https://github.com/apache/hertzbeat/edit/master/home/docs/help/issue.md",tags:[],version:"current",frontMatter:{id:"issue",title:"Common issues",sidebar_label:"Common issues"},sidebar:"docs",previous:{title:"RISC-V",permalink:"/docs/help/risc-v"},next:{title:"Custom Monitoring",permalink:"/docs/advanced/extend-point"}},l={},c=[{value:"Monitoring common issues",id:"monitoring-common-issues",level:3},{value:"Docker Deployment common issues",id:"docker-deployment-common-issues",level:3},{value:"Package Deployment common issues",id:"package-deployment-common-issues",level:3}],p={toc:c};function m({components:e,...t}){return(0,a.yg)("wrapper",(0,o.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,a.yg)("h3",{id:"monitoring-common-issues"},"Monitoring common issues"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Page feedback\uff1amonitor.host: Monitoring Host must be ipv4, ipv6 or domain name")),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"As shown in the information, the entered monitoring Host must be ipv4, ipv6 or domain name, and cannot carry a protocol header, such as http"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"The website API and other monitoring feedback statusCode:403 or 401, but the opposite end service itself does not need authentication, and the direct access of the browser is OK")),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"Please check whether it is blocked by the firewall. For example, BaoTa/aaPanel have set the blocking of ",(0,a.yg)("inlineCode",{parentName:"p"},"User-Agent=Apache-HttpClient")," in the request header by default. If it is blocked, please delete this blocking rule. (user-agent has been simulated as a browser in the v1.0.beat5 version. This problem does not exist)"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Ping connectivity monitoring exception when installing hertzbeat for package deployment.",(0,a.yg)("br",{parentName:"p"}),"\n","The hertzbeat installed and deployed by the installation package is not available for ping connectivity monitoring, but local direct ping is available \u3002"),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"The deployment of the installation package requires configuring the root permission of the Java virtual machine to start hertzbeat to use ICMP. If the root permission is not enabled, judge whether port 7 of telnet opposite end is opened.",(0,a.yg)("br",{parentName:"p"}),"\n","When you install HertzBeat via DockerDocker root is enabled by default. No such problem.",(0,a.yg)("br",{parentName:"p"}),"\n","See ",(0,a.yg)("a",{parentName:"p",href:"https://stackoverflow.com/questions/11506321/how-to-ping-an-ip-address"},"https://stackoverflow.com/questions/11506321/how-to-ping-an-ip-address")))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Configured Kubernetes monitoring, but the actual monitoring is not executing at the correct interval",(0,a.yg)("br",{parentName:"p"}),"\n","Please troubleshoot the issue by following these steps:"),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("ol",{parentName:"blockquote"},(0,a.yg)("li",{parentName:"ol"},"First, check HertzBeat's error logs. If you see the message 'desc: SQL statement too long, check maxSQLLength config',"),(0,a.yg)("li",{parentName:"ol"},"You need to adjust the TDengine configuration file. Create a taos.cfg file on the server and modify # max length of an SQL : maxSQLLength 654800, then restart TDengine. Ensure the configuration file is properly mounted."),(0,a.yg)("li",{parentName:"ol"},"If TDengine fails to restart, adjust the configuration in the mounted data file. Refer to .../taosdata/dnode/dnodeEps.json and change dnodeFqdn to the Docker ID of the failed startup instance, then run docker restart tdengine.")))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},'Configured HTTP API monitoring for business interface probing to ensure service availability. The API has token authentication, e.g., "Authorization: Bearer eyJhbGciOiJIUzI1....". After configuration, testing returns "StatusCode 401". The server receives the token as "Authorization: Bearer%20eyJhbGciOiJIUzI1....". HertzBeat escapes spaces to %20, but the server does not unescape it, causing authentication failure. It is recommended to make the escaping feature optional.')),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"What is the task limit for a single collector?"),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"Specific limit parameters:",(0,a.yg)("br",{parentName:"p"}),"\n","Core thread count: Math.max(2, Runtime.getRuntime().availableProcessors()) \u2013 at least 2 threads, or equal to the number of CPU cores.",(0,a.yg)("br",{parentName:"p"}),"\n","Maximum thread count: Runtime.getRuntime().availableProcessors() * 16 \u2013 16 times the number of CPU cores.",(0,a.yg)("br",{parentName:"p"}),"\n","The limit depends entirely on the server's CPU core count. For example, on an 8-core CPU server, a maximum of 8 \xd7 16 = 128 collection tasks can be processed simultaneously. Exceeding this number triggers the error message. This is a dynamic configuration that adjusts automatically based on the hardware specifications of the runtime environment.",(0,a.yg)("br",{parentName:"p"}),"\n",'If the runtime exceeds the maximum thread count, an error will appear: "the worker pool is full, reject this metrics task, put in queue again".',(0,a.yg)("br",{parentName:"p"}),"\n","In such cases, it is recommended to configure a new collector in public mode. HertzBeat will automatically distribute tasks to other collectors, avoiding errors due to the task limit of a single collector.")))),(0,a.yg)("h3",{id:"docker-deployment-common-issues"},"Docker Deployment common issues"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"MYSQL, TDENGINE and HertzBeat are deployed on the same host by Docker,HertzBeat use localhost or 127.0.0.1 connect to the database but fail"),"\nThe problems lies in Docker container failed to visit and connect localhost port. Because the docker default network mode is Bridge mode which can't access local machine through localhost."),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"Solution A\uff1aConfigure application.yml. Change database connection address from localhost to external IP of the host machine.",(0,a.yg)("br",{parentName:"p"}),"\n","Solution B\uff1aUse the Host network mode to start Docker, namely making Docker container and hosting share network. ",(0,a.yg)("inlineCode",{parentName:"p"},"docker run -d --network host .....")))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"According to the process deploy\uff0cvisit ",(0,a.yg)("a",{parentName:"strong",href:"http://ip:1157/"},"http://ip:1157/")," no interface"),"\nPlease refer to the following points to troubleshoot issues\uff1a"),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"one\uff1aWhether the MySQL database and tdengine database as dependent services have been successfully started, whether the corresponding hertzbeat database has been created, and whether the SQL script has been executed.\ntwo\uff1aCheck whether dependent service, IP account and password configuration is correct in HertzBeat's configuration file ",(0,a.yg)("inlineCode",{parentName:"p"},"application.yml"),".",(0,a.yg)("br",{parentName:"p"}),"\n","three\uff1a",(0,a.yg)("inlineCode",{parentName:"p"},"docker logs hertzbeat")," Check whether the container log has errors. If you haven't solved the issue, report it to the communication group or community."))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Log an error TDengine connection or insert SQL failed")),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"one\uff1aCheck whether database account and password configured is correct, the database is created.",(0,a.yg)("br",{parentName:"p"}),"\n","two\uff1aIf you install TDengine2.3+ version, you must execute ",(0,a.yg)("inlineCode",{parentName:"p"},"systemctl start taosadapter")," to start adapter in addition to start the server.")))),(0,a.yg)("h3",{id:"package-deployment-common-issues"},"Package Deployment common issues"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"According to the process deploy\uff0cvisit ",(0,a.yg)("a",{parentName:"strong",href:"http://ip:1157/"},"http://ip:1157/")," no interface"),"\nPlease refer to the following points to troubleshoot issues:"),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"one\uff1aWhether the MySQL database and tdengine database as dependent services have been successfully started, whether the corresponding hertzbeat database has been created, and whether the SQL script has been executed.",(0,a.yg)("br",{parentName:"p"}),"\n","two\uff1aCheck whether dependent services, IP account and password configuration is correct in HertzBeat's configuration file ",(0,a.yg)("inlineCode",{parentName:"p"},"hertzbeat/config/application.yml"),".",(0,a.yg)("br",{parentName:"p"}),"\n","three\uff1a Check whether the running log has errors in ",(0,a.yg)("inlineCode",{parentName:"p"},"hertzbeat/logs/")," directory. If you haven't solved the issue, report it to the communication group or community.  "))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Log an error TDengine connection or insert SQL failed")),(0,a.yg)("blockquote",{parentName:"li"},(0,a.yg)("p",{parentName:"blockquote"},"one\uff1aCheck whether database account and password configured is correct, the database is created.",(0,a.yg)("br",{parentName:"p"}),"\n","two\uff1aIf you install TDengine2.3+ version, you must execute ",(0,a.yg)("inlineCode",{parentName:"p"},"systemctl start taosadapter")," to start adapter in addition to start the server.")))))}m.isMDXComponent=!0},58860(e,t,n){n.d(t,{xA:()=>p,yg:()=>h});var o=n(37953);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef(function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),h=a,d=u["".concat(l,".").concat(h)]||u[h]||m[h]||r;return n?o.createElement(d,i(i({ref:t},p),{},{components:n})):o.createElement(d,i({ref:t},p))});function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);