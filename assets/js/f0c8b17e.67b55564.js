"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[28779],{80852(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>a,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"help/zookeeper","title":"Monitoring Zookeeper","description":"Collect and monitor the general performance Metrics of Zookeeper.","source":"@site/docs/help/zookeeper.md","sourceDirName":"help","slug":"/help/zookeeper","permalink":"/docs/next/help/zookeeper","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hertzbeat/edit/master/home/docs/help/zookeeper.md","tags":[],"version":"current","frontMatter":{"id":"zookeeper","title":"Monitoring Zookeeper","sidebar_label":"Zookeeper Monitor","keywords":["open source monitoring tool","open source zookeeper monitoring tool","monitoring zookeeper metrics"]},"sidebar":"docs","previous":{"title":"Spring Cloud Gateway","permalink":"/docs/next/help/spring_gateway"},"next":{"title":"Apollo Configuration Center","permalink":"/docs/next/help/apollo"}}');var i=n(86070),s=n(60056);const d={id:"zookeeper",title:"Monitoring Zookeeper",sidebar_label:"Zookeeper Monitor",keywords:["open source monitoring tool","open source zookeeper monitoring tool","monitoring zookeeper metrics"]},o=void 0,c={},l=[{value:"PreRequisites",id:"prerequisites",level:3},{value:"Zookeeper four word command",id:"zookeeper-four-word-command",level:4},{value:"netcat protocol",id:"netcat-protocol",level:4},{value:"Configuration parameter",id:"configuration-parameter",level:3},{value:"Collection Metric",id:"collection-metric",level:3},{value:"Metric set\uff1aconf",id:"metric-setconf",level:4},{value:"Metric set\uff1astats",id:"metric-setstats",level:4},{value:"Metric set\uff1aenvi",id:"metric-setenvi",level:4}];function h(e){const t={blockquote:"blockquote",code:"code",h3:"h3",h4:"h4",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Collect and monitor the general performance Metrics of Zookeeper."}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"prerequisites",children:"PreRequisites"}),"\n",(0,i.jsx)(t.h4,{id:"zookeeper-four-word-command",children:"Zookeeper four word command"}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"The current implementation scheme uses the four word command provided by zookeeper to collect Metrics.\nUsers need to add the four word command of zookeeper to the white list by themselves."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Steps"}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"1.Find our zookeeper configuration file, which is usually zoo.cfg."}),"\n",(0,i.jsx)(t.p,{children:"2.Add the following commands to the configuration file"}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"# Add the required command to the white list\n4lw.commands.whitelist=stat, ruok, conf, isro\n\n# Add all commands to the white list\n4lw.commands.whitelist=*\n"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"3.Restart service"}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"zkServer.sh restart\n"})}),"\n",(0,i.jsx)(t.h4,{id:"netcat-protocol",children:"netcat protocol"}),"\n",(0,i.jsx)(t.p,{children:"The current implementation scheme requires us to deploy the Linux server of zookeeper\nCommand environment for installing netcat"}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"netcat installation steps"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"yum install -y nc\n"})}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"If the terminal displays the following information, the installation is successful"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"Complete!\n"})}),"\n",(0,i.jsx)(t.h3,{id:"configuration-parameter",children:"Configuration parameter"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter name"}),(0,i.jsx)(t.th,{children:"Parameter help description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Monitoring Host"}),(0,i.jsx)(t.td,{children:"Monitored IPV4, IPV6 or domain name. Note\u26a0\ufe0fWithout protocol header (eg: https://, http://)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Monitoring name"}),(0,i.jsx)(t.td,{children:"Identify the name of this monitoring. The name needs to be unique"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Port"}),(0,i.jsx)(t.td,{children:"Port provided by Zookeeper. The default is 2181"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Query timeout"}),(0,i.jsx)(t.td,{children:"Set the timeout of Zookeeper connection, unit: ms, default: 3000ms"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Username"}),(0,i.jsx)(t.td,{children:"User name of the Linux connection where Zookeeper is located"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Password"}),(0,i.jsx)(t.td,{children:"Password of the Linux connection where Zookeeper is located"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Collection interval"}),(0,i.jsx)(t.td,{children:"Interval time of monitor periodic data collection, unit: second, and the minimum interval that can be set is 30 seconds"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Whether to detect"}),(0,i.jsx)(t.td,{children:"Whether to detect and check the availability of monitoring before adding monitoring. Adding and modifying operations will continue only after the detection is successful"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Description remarks"}),(0,i.jsx)(t.td,{children:"For more information about identifying and describing this monitoring, users can note information here"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"collection-metric",children:"Collection Metric"}),"\n",(0,i.jsx)(t.h4,{id:"metric-setconf",children:"Metric set\uff1aconf"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Metric name"}),(0,i.jsx)(t.th,{children:"Metric unit"}),(0,i.jsx)(t.th,{children:"Metric help description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"clientPort"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Port"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"dataDir"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Data snapshot file directory. By default, 100000 operations generate a snapshot"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"dataDirSize"}),(0,i.jsx)(t.td,{children:"kb"}),(0,i.jsx)(t.td,{children:"Data snapshot file size"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"dataLogDir"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Transaction log file directory, production environment on a separate disk"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"dataLogSize"}),(0,i.jsx)(t.td,{children:"kb"}),(0,i.jsx)(t.td,{children:"Transaction log file size"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"tickTime"}),(0,i.jsx)(t.td,{children:"ms"}),(0,i.jsx)(t.td,{children:"Time interval between servers or between clients and servers to maintain heartbeat"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"minSessionTimeout"}),(0,i.jsx)(t.td,{children:"ms"}),(0,i.jsx)(t.td,{children:"Minimum session timeout. Heartbeat timex2. The specified time is less than this time, which is used by default"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"maxSessionTimeout"}),(0,i.jsx)(t.td,{children:"ms"}),(0,i.jsx)(t.td,{children:"Maximum session timeout. Heartbeat timex20. The specified time is greater than this time, which is used by default"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"serverId"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Server id"})]})]})]}),"\n",(0,i.jsx)(t.h4,{id:"metric-setstats",children:"Metric set\uff1astats"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Metric name"}),(0,i.jsx)(t.th,{children:"Metric unit"}),(0,i.jsx)(t.th,{children:"Metric help description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_version"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Server version"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_server_state"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Server role"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_num_alive_connections"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of connections"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_avg_latency"}),(0,i.jsx)(t.td,{children:"ms"}),(0,i.jsx)(t.td,{children:"Average latency"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_outstanding_requests"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of outstanding requests"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_znode_count"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of znode"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_packets_sent"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of packets sent"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_packets_received"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of packets received"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_watch_count"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of watch"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_max_file_descriptor_count"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Maximum number of file descriptors"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_approximate_data_size"}),(0,i.jsx)(t.td,{children:"kb"}),(0,i.jsx)(t.td,{children:"data size"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_open_file_descriptor_count"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of open file descriptors"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_max_latency"}),(0,i.jsx)(t.td,{children:"ms"}),(0,i.jsx)(t.td,{children:"Max latency"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_ephemerals_count"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsx)(t.td,{children:"Number of ephemeral nodes"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_min_latency"}),(0,i.jsx)(t.td,{children:"ms"}),(0,i.jsx)(t.td,{children:"Min latency"})]})]})]}),"\n",(0,i.jsx)(t.h4,{id:"metric-setenvi",children:"Metric set\uff1aenvi"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Metric Name"}),(0,i.jsx)(t.th,{children:"Metric Unit"}),(0,i.jsx)(t.th,{children:"Metric help description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"zk_version"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"ZooKeeper version"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"hostname"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Hostname"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"java_version"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Java version"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"java_vendor"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Java vendor"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"java_home"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Java home directory"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"java_class_path"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Java class path"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"java_library_path"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Java library path"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"java_io_tmpdir"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Java temporary directory"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"java_compiler"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Java compiler"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"os_name"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Operating system name"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"os_arch"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Operating system architecture"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"os_version"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Operating system version"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"user_name"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"Username"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"user_home"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"User home directory"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"user_dir"}),(0,i.jsx)(t.td,{children:"none"}),(0,i.jsx)(t.td,{children:"User current directory"})]})]})]})]})}function a(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},60056(e,t,n){n.d(t,{R:()=>d,x:()=>o});var r=n(30758);const i={},s=r.createContext(i);function d(e){const t=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);