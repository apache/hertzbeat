"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[43594],{60594(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>m});const i=JSON.parse('{"id":"advanced/extend-jmx","title":"JMX Protocol Custom Monitoring","description":"From Custom Monitoring, you are familiar with how to customize types, Metrics, protocols, etc. Here we will introduce in detail how to use JMX to customize Metric monitoring.","source":"@site/versioned_docs/version-1.6.x/advanced/extend-jmx.md","sourceDirName":"advanced","slug":"/advanced/extend-jmx","permalink":"/docs/1.6.x/advanced/extend-jmx","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hertzbeat/edit/master/home/versioned_docs/version-1.6.x/advanced/extend-jmx.md","tags":[],"version":"1.6.x","frontMatter":{"id":"extend-jmx","title":"JMX Protocol Custom Monitoring","sidebar_label":"JMX Protocol Custom Monitoring"},"sidebar":"docs","previous":{"title":"Telnet Protocol Custom Monitoring","permalink":"/docs/1.6.x/advanced/extend-telnet"},"next":{"title":"SNMP Protocol Custom Monitoring","permalink":"/docs/1.6.x/advanced/extend-snmp"}}');var o=t(86070),r=t(60056);const s={id:"extend-jmx",title:"JMX Protocol Custom Monitoring",sidebar_label:"JMX Protocol Custom Monitoring"},a=void 0,l={},m=[{value:"JMX protocol collection process",id:"jmx-protocol-collection-process",level:3},{value:"Data parsing method",id:"data-parsing-method",level:3},{value:"Custom Steps",id:"custom-steps",level:3},{value:"Monitoring Templates YML",id:"monitoring-templates-yml",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h3:"h3",hr:"hr",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["From ",(0,o.jsx)(n.a,{href:"extend-point",children:"Custom Monitoring"}),", you are familiar with how to customize types, Metrics, protocols, etc. Here we will introduce in detail how to use JMX to customize Metric monitoring.\nJMX protocol custom monitoring allows us to easily monitor Metrics we want by config JMX Mbeans Object."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"jmx-protocol-collection-process",children:"JMX protocol collection process"}),"\n",(0,o.jsxs)(n.p,{children:["\u3010",(0,o.jsx)(n.strong,{children:"Peer Server Enable Jmx Service"}),"\u3011->\u3010",(0,o.jsx)(n.strong,{children:"HertzBeat Connect Peer Server Jmx"}),"\u3011->\u3010",(0,o.jsx)(n.strong,{children:"Query Jmx Mbean Object Data"}),"\u3011->\u3010",(0,o.jsx)(n.strong,{children:"Metric data extraction"}),"\u3011"]}),"\n",(0,o.jsx)(n.p,{children:"It can be seen from the process that we define a monitoring type of JMX protocol. We need to configure JMX request parameters, configure which Metrics to obtain, and configure Mbeans Object."}),"\n",(0,o.jsx)(n.h3,{id:"data-parsing-method",children:"Data parsing method"}),"\n",(0,o.jsxs)(n.p,{children:["By configuring the monitoring template YML metrics ",(0,o.jsx)(n.code,{children:"field"}),", ",(0,o.jsx)(n.code,{children:"aliasFields"}),", ",(0,o.jsx)(n.code,{children:"objectName"})," of the ",(0,o.jsx)(n.code,{children:"jmx"})," protocol to map and parse the ",(0,o.jsx)(n.code,{children:"Mbean"})," object information exposed by the peer system."]}),"\n",(0,o.jsx)(n.h3,{id:"custom-steps",children:"Custom Steps"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"HertzBeat Dashboard"})," -> ",(0,o.jsx)(n.strong,{children:"Monitoring Templates"})," -> ",(0,o.jsx)(n.strong,{children:"New Template"})," -> ",(0,o.jsx)(n.strong,{children:"Config Monitoring Template Yml"})," -> ",(0,o.jsx)(n.strong,{children:"Save and Apply"})," -> ",(0,o.jsx)(n.strong,{children:"Add A Monitoring with The New Monitoring Type"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"HertzBeat",src:t(87392).A+"",width:"4064",height:"2166"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.p,{children:"Configuration usages of the monitoring templates yml are detailed below."}),"\n",(0,o.jsx)(n.h3,{id:"monitoring-templates-yml",children:"Monitoring Templates YML"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"We define all monitoring collection types (mysql,jvm,k8s) as yml monitoring templates, and users can import these templates to support corresponding types of monitoring."}),"\n",(0,o.jsxs)(n.p,{children:["Monitoring template is used to define ",(0,o.jsx)(n.em,{children:"the name of monitoring type(international), request parameter mapping, index information, collection protocol configuration information"}),", etc."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["eg\uff1aDefine a custom monitoring type ",(0,o.jsx)(n.code,{children:"app"})," named ",(0,o.jsx)(n.code,{children:"example_jvm"})," which use the JVM protocol to collect data."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# The monitoring type category\uff1aservice-application service monitoring db-database monitoring custom-custom monitoring os-operating system monitoring\ncategory: service\n# The monitoring type eg: linux windows tomcat mysql aws...\napp: example_jvm\n# The monitoring i18n name\nname:\n  zh-CN: \u81ea\u5b9a\u4e49JVM\u865a\u62df\u673a\n  en-US: CUSTOM JVM\n# Input params define for monitoring(render web ui by the definition)\nparams:\n  # field-param field key\n  - field: host\n    # name-param field display i18n name\n    name:\n      zh-CN: \u4e3b\u673aHost\n      en-US: Host\n    # type-param field type(most mapping the html input type)\n    type: host\n    # required-true or false\n    required: true\n  # field-param field key\n  - field: port\n    # name-param field display i18n name\n    name:\n      zh-CN: \u7aef\u53e3\n      en-US: Port\n    # type-param field type(most mapping the html input type)\n    type: number\n    # when type is number, range is required\n    range: '[0,65535]'\n    # required-true or false\n    required: true\n    # default value\n    defaultValue: 9999\n  # field-param field key\n  - field: url\n    # name-param field display i18n name\n    name:\n      zh-CN: JMX URL\n      en-US: JMX URL\n    # type-param field type(most mapping the html input type)\n    type: text\n    # required-true or false\n    required: false\n    # hide param-true or false\n    hide: true\n    # param field input placeholder\n    placeholder: 'service:jmx:rmi:///jndi/rmi://host:port/jmxrmi'\n  # field-param field key\n  - field: username\n    # name-param field display i18n name\n    name:\n      zh-CN: \u7528\u6237\u540d\n      en-US: Username\n    # type-param field type(most mapping the html input type)\n    type: text\n    # when type is text, use limit to limit string length\n    limit: 50\n    # required-true or false\n    required: false\n    # hide param-true or false\n    hide: true\n  # field-param field key\n  - field: password\n    # name-param field display i18n name\n    name:\n      zh-CN: \u5bc6\u7801\n      en-US: Password\n    # type-param field type(most mapping the html input tag)\n    type: password\n    # required-true or false\n    required: false\n    # hide param-true or false\n    hide: true\n# collect metrics config list\nmetrics:\n  # metrics - basic\n  - name: basic\n    # metrics scheduling priority(0->127)->(high->low), metrics with the same priority will be scheduled in parallel\n    # priority 0's metrics is availability metrics, it will be scheduled first, only availability metrics collect success will the scheduling continue\n    priority: 0\n    # collect metrics content\n    fields:\n      # field-metric name, type-metric type(0-number,1-string), unit-metric unit('%','ms','MB'), label-if is metrics label\n      - field: VmName\n        type: 1\n      - field: VmVendor\n        type: 1\n      - field: VmVersion\n        type: 1\n      - field: Uptime\n        type: 0\n        unit: ms\n    # the protocol used for monitoring, eg: sql, ssh, http, telnet, wmi, snmp, sdk\n    protocol: jmx\n    # the config content when protocol is jmx\n    jmx:\n      # host: ipv4 ipv6 domain\n      host: ^_^host^_^\n      # port\n      port: ^_^port^_^\n      username: ^_^username^_^\n      password: ^_^password^_^\n      # jmx mbean object name\n      objectName: java.lang:type=Runtime\n      url: ^_^url^_^\n\n  - name: memory_pool\n    priority: 1\n    fields:\n      - field: name\n        type: 1\n        label: true\n      - field: committed\n        type: 0\n        unit: MB\n      - field: init\n        type: 0\n        unit: MB\n      - field: max\n        type: 0\n        unit: MB\n      - field: used\n        type: 0\n        unit: MB\n    units:\n      - committed=B->MB\n      - init=B->MB\n      - max=B->MB\n      - used=B->MB\n    # (optional)metrics field alias name, it is used as an alias field to map and convert the collected data and metrics field\n    aliasFields:\n      - Name\n      - Usage->committed\n      - Usage->init\n      - Usage->max\n      - Usage->used\n    # mapping and conversion expressions, use these and aliasField above to calculate metrics value\n    # eg: cores=core1+core2, usage=usage, waitTime=allTime-runningTime\n    calculates:\n      - name=Name\n      - committed=Usage->committed\n      - init=Usage->init\n      - max=Usage->max\n      - used=Usage->used\n    protocol: jmx\n    jmx:\n      # host: ipv4 ipv6 domain\n      host: ^_^host^_^\n      # port\n      port: ^_^port^_^\n      username: ^_^username^_^\n      password: ^_^password^_^\n      objectName: java.lang:type=MemoryPool,name=*\n      url: ^_^url^_^\n"})})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},87392(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/extend-point-1-0175fbb6d4bd1105c2596f7ccae83938.png"},60056(e,n,t){t.d(n,{R:()=>s,x:()=>a});var i=t(30758);const o={},r=i.createContext(o);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);