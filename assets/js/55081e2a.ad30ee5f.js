"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[73100],{45906:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>o});var i=n(30758);const r={},s=i.createContext(r);function c(e){const t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(s.Provider,{value:t},e.children)}},77541:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>a,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"help/shenyu","title":"Monitoring\uff1aApache ShenYu API Gateway","description":"monitor ShenYu running status (JVM-related), include request response and other related metrics.","source":"@site/versioned_docs/version-1.8.0/help/shenyu.md","sourceDirName":"help","slug":"/help/shenyu","permalink":"/docs/help/shenyu","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hertzbeat/edit/master/home/versioned_docs/version-1.8.0/help/shenyu.md","tags":[],"version":"1.8.0","frontMatter":{"id":"shenyu","title":"Monitoring\uff1aApache ShenYu API Gateway","sidebar_label":"Apache ShenYu","keywords":["open source monitoring tool","open source apache shenyu monitoring tool","monitoring apache shenyu metrics"]},"sidebar":"docs","previous":{"title":"Apache RocketMQ","permalink":"/docs/help/rocketmq"},"next":{"title":"Spring Cloud Gateway","permalink":"/docs/help/spring_gateway"}}');var r=n(86070),s=n(45906);const c={id:"shenyu",title:"Monitoring\uff1aApache ShenYu API Gateway",sidebar_label:"Apache ShenYu",keywords:["open source monitoring tool","open source apache shenyu monitoring tool","monitoring apache shenyu metrics"]},o=void 0,l={},d=[{value:"Pre-monitoring operations",id:"pre-monitoring-operations",level:2},{value:"Configuration parameters",id:"configuration-parameters",level:3},{value:"Collect metrics",id:"collect-metrics",level:3},{value:"Index collection: shenyu_request_total",id:"index-collection-shenyu_request_total",level:4},{value:"Metric collection: shenyu_request_throw_created",id:"metric-collection-shenyu_request_throw_created",level:4},{value:"Metric collection: process_cpu_seconds_total",id:"metric-collection-process_cpu_seconds_total",level:4},{value:"Metric collection: process_open_fds",id:"metric-collection-process_open_fds",level:4},{value:"Metric collection: process_max_fds",id:"metric-collection-process_max_fds",level:4},{value:"Metric collection: jvm_info",id:"metric-collection-jvm_info",level:4},{value:"Metric collection: jvm_memory_bytes_used",id:"metric-collection-jvm_memory_bytes_used",level:4},{value:"Metric collection: jvm_memory_pool_bytes_used",id:"metric-collection-jvm_memory_pool_bytes_used",level:4},{value:"Metric collection: jvm_memory_pool_bytes_committed",id:"metric-collection-jvm_memory_pool_bytes_committed",level:4},{value:"Metric collection: jvm_memory_pool_bytes_max",id:"metric-collection-jvm_memory_pool_bytes_max",level:4},{value:"Metric collection: jvm_threads_state",id:"metric-collection-jvm_threads_state",level:4}];function h(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:"monitor ShenYu running status (JVM-related), include request response and other related metrics."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"pre-monitoring-operations",children:"Pre-monitoring operations"}),"\n",(0,r.jsxs)(t.p,{children:["Enable ",(0,r.jsx)(t.code,{children:"metrics"})," plugin in ShenYu, expose it's prometheus metrics endpoint\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["Refer ",(0,r.jsx)(t.a,{href:"https://shenyu.apache.org/docs/plugin-center/observability/metrics-plugin",children:"ShenYu Document"})]}),"\n",(0,r.jsx)(t.p,{children:"Two Steps Mainly:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"add metrics plugin dependency in gateway's pom.xml."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-spring-boot-starter-plugin-metrics</artifactId>\n    <version>${project.version}</version>\n</dependency>\n"})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"modify this config in shenyu gateway yaml."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"shenyu:\n  metrics:\n    enabled: false #false is close, true is open\n    name : prometheus \n    host: 127.0.0.1 \n    port: 8090 \n    jmxConfig: \n    props:\n      jvm_enabled: true #enable jvm monitoring\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["Finally, restart the access gateway metrics endpoint ",(0,r.jsx)(t.code,{children:"http://ip:8090"})," to respond to prometheus format data."]}),"\n",(0,r.jsx)(t.h3,{id:"configuration-parameters",children:"Configuration parameters"}),"\n",(0,r.jsx)(t.p,{children:"| Parameter name | Parameter help description |\n|--------|----------------------------------------- --------------|\n| Monitoring Host | The peer IPV4, IPV6 or domain name to be monitored. Note \u26a0\ufe0fWithout protocol header (eg: https://, http://). |\n| Monitoring name | The name that identifies this monitoring, and the name needs to be unique. |\n| Port | The port provided by the gateway Metric interface, the default is 8090. |\n| Timeout | HTTP request response timeout |\n| Acquisition Interval | Interval time for monitoring periodic data collection, in seconds, the minimum interval that can be set is 30 seconds |\n| Whether to detect | Whether to detect and check the availability of monitoring before adding monitoring, and the operation of adding and modifying will continue after the detection is successful |\n| Description Remarks | More remark information to identify and describe this monitoring, users can remark information here |"}),"\n",(0,r.jsx)(t.h3,{id:"collect-metrics",children:"Collect metrics"}),"\n",(0,r.jsx)(t.h4,{id:"index-collection-shenyu_request_total",children:"Index collection: shenyu_request_total"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"Collect all requests from ShenYu gateway"})]})})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-shenyu_request_throw_created",children:"Metric collection: shenyu_request_throw_created"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"Collect the number of abnormal requests from ShenYu Gateway"})]})})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-process_cpu_seconds_total",children:"Metric collection: process_cpu_seconds_total"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"total user and system CPU elapsed seconds"})]})})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-process_open_fds",children:"Metric collection: process_open_fds"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"number of open file descriptors"})]})})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-process_max_fds",children:"Metric collection: process_max_fds"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"maximum number of open file descriptors"})]})})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-jvm_info",children:"Metric collection: jvm_info"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"runtime"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"JVM version information"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"vendor"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"JVM version information"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"version"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"JVM version information"})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-jvm_memory_bytes_used",children:"Metric collection: jvm_memory_bytes_used"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"area"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"JVM memory area"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"MB"}),(0,r.jsx)(t.td,{children:"used size of the given JVM memory region"})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-jvm_memory_pool_bytes_used",children:"Metric collection: jvm_memory_pool_bytes_used"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"pool"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"JVM memory pool"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"MB"}),(0,r.jsx)(t.td,{children:"used size of the given JVM memory pool"})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-jvm_memory_pool_bytes_committed",children:"Metric collection: jvm_memory_pool_bytes_committed"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"pool"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"JVM memory pool"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"MB"}),(0,r.jsx)(t.td,{children:"The committed size of the given JVM memory pool"})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-jvm_memory_pool_bytes_max",children:"Metric collection: jvm_memory_pool_bytes_max"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"pool"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"JVM memory pool"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"MB"}),(0,r.jsx)(t.td,{children:"The maximum size of the memory pool for the given JVM"})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"metric-collection-jvm_threads_state",children:"Metric collection: jvm_threads_state"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Metric Name"}),(0,r.jsx)(t.th,{children:"Metric Unit"}),(0,r.jsx)(t.th,{children:"Metric Help Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"state"}),(0,r.jsx)(t.td,{children:"none"}),(0,r.jsx)(t.td,{children:"thread state"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"value"}),(0,r.jsx)(t.td,{children:"None"}),(0,r.jsx)(t.td,{children:"The number of threads corresponding to the thread state"})]})]})]})]})}function a(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);