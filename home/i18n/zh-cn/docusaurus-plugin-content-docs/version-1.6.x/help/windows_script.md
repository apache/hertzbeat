---
id: windows_script
title: 监控：使用脚本监控 Windows 操作系统   
sidebar_label: 使用脚本监控 Windows 操作系统
keywords: [开源监控系统, 开源网络监控, 使用脚本监控 Windows 操作系统]
---

### 准备工作

> 若要监控本机，部署 Hertzbeat 即可，若要监控其他主机，需在目标主机上部署采集器，部署采集器可参考[此链接](https://github.com/apache/hertzbeat?tab=readme-ov-file#2install-via-package)的第 5 步。
> 如果使用 Docker 安装采集器，则会导致采集器监控不到宿主机上的进程信息，因为 Docker 容器在一个独立的环境中运行，每个容器都有自己的进程空间。
> 在创建监控任务选择采集器时，需选择目标主机上对应的采集器。

### 配置参数

| 参数名称   |             参数帮助描述              |
|:-------|---------------------------------|---|
| 监控 Host | 被监控的对端 IPV4，IPV6 或域名。注意⚠️不带协议头(eg: https://, http://)。           |
| 任务名称   | 标识此监控的名称，名称需要保证唯一性。             |   |
| 采集器    | 配置此监控使用哪台采集器调度采集。               |
| 监控周期   | 监控周期性采集数据间隔时间，单位秒。 |
| 绑定标签   | 对监控资源的分类管理标签。                   |
| 描述备注   | 更多标识和描述此监控的备注信息，用户可以在这里备注信息。    |

### 采集指标

#### 指标集合：basic

|   指标名称   | 指标单位 | 指标帮助描述 |
|----------|------|--------|
| hostname | 无    | 主机名称   |
| version  | 无    | 操作系统版本 |

#### 指标集合：cpu

| 指标名称           | 指标单位 | 指标帮助描述      |
|----------------|------|-------------|
| info           | 无    | CPU 型号      |
| cores          | 核数   | CPU 内核数量    |
| interrupt      | 个数   | CPU 中断数量    |
| load           | 无    | CPU 最近的平均负载 |
| context_switch | 个数   | 当前上下文切换数量   |
| usage          | %    | CPU 使用率     |

#### 指标集合：memory

| 指标名称          | 指标单位 | 指标帮助描述   |
|---------------|------|----------|
| totalPhysical | Mb   | 总物理内存容量  |
| freePhysical  | Mb   | 空闲物理内存容量 |
| totalVirtual  | Mb   | 总虚拟内存容量  |
| freeVirtual   | Mb   | 空闲虚拟内存容量 |

#### 指标集合：disk

| 指标名称           | 指标单位 | 指标帮助描述  |
|----------------|------|---------|
| Model          | 无    | 磁盘型号    |
| Size           | Mb   | 磁盘大小    |
| BytesPerSector | 字节   | 每个扇区字节数 |

#### 指标集合：disk_free

| 指标名称      | 指标单位 | 指标帮助描述 |
|-----------|------|--------|
| Caption   | 无    | 盘符     |
| FreeSpace | Mb   | 可用空间大小 |
| Size      | Mb   | 总空间大小  |

#### 指标集合：CPU 占用率前10的程序

| 指标名称 | 指标单位 | 指标帮助描述   |
|------|------|----------|
| name | 无    | 进程名称     |
| id   | 无    | 进程 id    |
| cpu  | 秒    | cpu 使用时间 |
| ws   | Mb   | 内存占用量    |

#### 指标集合：内存占用率前10的程序

| 指标名称 | 指标单位 | 指标帮助描述   |
|------|------|----------|
| name | 无    | 进程名称     |
| id   | 无    | 进程 id    |
| cpu  | 秒    | cpu 使用时间 |
| ws   | Mb   | 内存占用量    |
