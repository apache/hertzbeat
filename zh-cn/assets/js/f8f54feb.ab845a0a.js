"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[13821],{60933(e,n,l){l.r(n),l.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>o,frontMatter:()=>s,metadata:()=>t,toc:()=>i});var t=l(12128),a=l(86070),r=l(60056);const s={},c="HertzBeat \u4ece 1.6.1 \u7248\u672c\u5347\u7ea7\u5230 1.7.0 \u7248\u672c\u6307\u5f15-(Helm Mode)",d={authorsImageUrls:[]},i=[{value:"1. \u524d\u7f6e\u51c6\u5907",id:"1-\u524d\u7f6e\u51c6\u5907",level:2},{value:"2. \u5347\u7ea7\u6b65\u9aa4",id:"2-\u5347\u7ea7\u6b65\u9aa4",level:2},{value:"1. \u62c9\u53d6\u6700\u65b0Chart\u5230\u672c\u5730",id:"1-\u62c9\u53d6\u6700\u65b0chart\u5230\u672c\u5730",level:3},{value:"2. \u4fee\u6539values.yaml",id:"2-\u4fee\u6539valuesyaml",level:3},{value:"3. \u6d4b\u8bd5\u5347\u7ea7(\u5e72\u8fd0\u884c)",id:"3-\u6d4b\u8bd5\u5347\u7ea7\u5e72\u8fd0\u884c",level:3},{value:"4. \u6267\u884c\u5347\u7ea7",id:"4-\u6267\u884c\u5347\u7ea7",level:3},{value:"5. \u9a8c\u8bc1\u5347\u7ea7",id:"5-\u9a8c\u8bc1\u5347\u7ea7",level:3}];function h(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"1-\u524d\u7f6e\u51c6\u5907",children:"1. \u524d\u7f6e\u51c6\u5907"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u786e\u4fdd\u5df2\u5b89\u88c5\u4ee5\u4e0b\u5de5\u5177:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Helm 3.x"}),"\n",(0,a.jsx)(n.li,{children:"kubectl"}),"\n",(0,a.jsx)(n.li,{children:"Git (\u53ef\u9009)"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u786e\u8ba4\u5f53\u524d\u90e8\u7f72\u4fe1\u606f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm list -n <your-namespace>\n# \u5982\u679c\u4f60\u8001\u7248\u672c\u7684chart\u5305\u4e0d\u89c1\u4e86\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5bfc\u51favalues.yaml\u6587\u4ef6\nhelm get values hertzbeat -n <your-namespace> > hertzbeat-1.6.1-values.yaml\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u6570\u636e\u5907\u4efd"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u82e5\u4f7f\u7528\u4e86\u81ea\u5b9a\u4e49\u76d1\u63a7\u6a21\u677f"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u9700\u8981\u5907\u4efd ",(0,a.jsx)(n.code,{children:"kubectl cp hertzbeat/hertzbeat-978477f84-fr894:/opt/hertzbeat/define ./define"})," \u5f53\u524d\u8fd0\u884c pod\u91cc\u9762\u7684 ",(0,a.jsx)(n.code,{children:"/opt/hertzbeat/define"})," \u76ee\u5f55\u5230\u5f53\u524d\u4e3b\u673a\u4e0b,\u5982\u679c\u505a\u4e86\u6301\u4e45\u5316 \u8bf7\u62f7\u8d1d\u6301\u4e45\u5316\u76ee\u5f55"]}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"kubectl cp hertzbeat/hertzbeat-978477f84-fr894:/opt/hertzbeat/define ./define"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u82e5\u4f7f\u7528\u5916\u7f6e\u5173\u7cfb\u578b\u6570\u636e\u5e93 Mysql, PostgreSQL\u6570\u636e"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u4e00\u822c\u4f7f\u7528helm\u90e8\u7f72\u90e8\u7f72\u90fd\u505a\u4e86\u6301\u4e45\u5316\uff0c\u53ef\u4ee5\u9009\u62e9\u62f7\u8d1d\u6301\u4e45\u5316\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7mysqldump\u3001pgdump\u7b49\u5de5\u5177\u5b8c\u6210\u5907\u4efd"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:" kubectl get pvc -n hertzbeat\nNAME                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nhertzbeat-database   Bound    pvc-c63cf479-0033-423b-8466-eb00aa181657   4Gi        RWO            standard       68d\nhertzbeat-ext-lib    Bound    pvc-31fee163-1211-424f-8966-e3e805c23ff5   1Gi        RWX            standard       68d\nhertzbeat-tsdb       Bound    pvc-4f2ef614-0302-4a4c-8dd4-e68b34e9061c   4Gi        RWO            standard       68d\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"2-\u5347\u7ea7\u6b65\u9aa4",children:"2. \u5347\u7ea7\u6b65\u9aa4"}),"\n",(0,a.jsx)(n.h3,{id:"1-\u62c9\u53d6\u6700\u65b0chart\u5230\u672c\u5730",children:"1. \u62c9\u53d6\u6700\u65b0Chart\u5230\u672c\u5730"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm repo update\nhelm pull hertzbeat/hertzbeat --version 1.7.0 --untar\ncd hertzbeat\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6216\u8005\u4eceGitHub\u4ed3\u5e93\u83b7\u53d6(\u6309\u9700\u4fee\u6539Chart):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/hertzbeat/helm-charts.git\ncd helm-charts/charts/hertzbeat\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2-\u4fee\u6539valuesyaml",children:"2. \u4fee\u6539values.yaml"}),"\n",(0,a.jsx)(n.p,{children:"\u6bd4\u8f83\u5e76\u5408\u5e76\u60a8\u7684\u81ea\u5b9a\u4e49\u914d\u7f6e\u5230\u65b0\u7248\u672cvalues.yaml:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u4f7f\u7528diff\u5de5\u5177\u6bd4\u8f83\u65b0\u65e7values\u6587\u4ef6\ndiff -u ../hertzbeat-1.6.1-values.yaml values.yaml\nvimdiff \u5bf9\u7740\u4fee\u6539\uff0c\u6539\u5b8c\u7ee7\u7eeddiff\uff0c\u65e0\u8f93\u51fa\u5219\u6b63\u5e38\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5e38\u89c1\u9700\u8981\u5173\u6ce8\u7684\u914d\u7f6e\u9879:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u955c\u50cf\u7248\u672c: ",(0,a.jsx)(n.code,{children:"image.tag"})]}),"\n",(0,a.jsxs)(n.li,{children:["\u8d44\u6e90\u9650\u5236: ",(0,a.jsx)(n.code,{children:"resources"})]}),"\n",(0,a.jsxs)(n.li,{children:["\u6301\u4e45\u5316\u914d\u7f6e: ",(0,a.jsx)(n.code,{children:"persistence"})]}),"\n",(0,a.jsxs)(n.li,{children:["\u670d\u52a1\u7c7b\u578b: ",(0,a.jsx)(n.code,{children:"service.type"})]}),"\n",(0,a.jsx)(n.li,{children:"Ingress\u914d\u7f6e"}),"\n",(0,a.jsx)(n.li,{children:"\u6570\u636e\u5e93\u914d\u7f6e(\u5982\u679c\u4f7f\u7528\u5916\u90e8\u6570\u636e\u5e93)"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"3-\u6d4b\u8bd5\u5347\u7ea7\u5e72\u8fd0\u884c",children:"3. \u6d4b\u8bd5\u5347\u7ea7(\u5e72\u8fd0\u884c)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm upgrade hertzbeat . -n <your-namespace> \\\n  --values values.yaml \\\n  --dry-run \\\n  --debug\n"})}),"\n",(0,a.jsx)(n.h3,{id:"4-\u6267\u884c\u5347\u7ea7",children:"4. \u6267\u884c\u5347\u7ea7"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm upgrade hertzbeat . -n <your-namespace> \\\n  --values values.yaml \\\n  --atomic \\          # \u5347\u7ea7\u5931\u8d25\u81ea\u52a8\u56de\u6eda\n  --timeout 10m       # \u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\n"})}),"\n",(0,a.jsx)(n.h3,{id:"5-\u9a8c\u8bc1\u5347\u7ea7",children:"5. \u9a8c\u8bc1\u5347\u7ea7"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5\u53d1\u5e03\u72b6\u6001\nhelm status hertzbeat -n <your-namespace>\n\n# \u68c0\u67e5Pod\u72b6\u6001\nkubectl get pods -n <your-namespace> -l app.kubernetes.io/instance=hertzbeat\n\n# \u68c0\u67e5\u65e5\u5fd7\nkubectl logs -n <your-namespace> -l app.kubernetes.io/instance=hertzbeat --tail=100\n"})})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},60056(e,n,l){l.d(n,{R:()=>s,x:()=>c});var t=l(30758);const a={},r=t.createContext(a);function s(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(r.Provider,{value:n},e.children)}},12128(e){e.exports=JSON.parse('{"permalink":"/zh-cn/blog/2025/04/23/hertzbeat-upgrade-guide-from-v1.6.1-to-v1.7.0-helm-mode","editUrl":"https://github.com/apache/hertzbeat/edit/master/home/i18n/zh-cn/docusaurus-plugin-content-blog/2025-04-23-hertzbeat-upgrade-guide-from-v1.6.1-to-v1.7.0-helm-mode.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/2025-04-23-hertzbeat-upgrade-guide-from-v1.6.1-to-v1.7.0-helm-mode.md","title":"HertzBeat \u4ece 1.6.1 \u7248\u672c\u5347\u7ea7\u5230 1.7.0 \u7248\u672c\u6307\u5f15-(Helm Mode)","description":"1. \u524d\u7f6e\u51c6\u5907","date":"2025-04-23T00:00:00.000Z","tags":[],"readingTime":1.96,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"HertzBeat \u5347\u7ea7\u6307\u5bfc-(Docker Mode)","permalink":"/zh-cn/blog/2025/04/23/hertzbeat-upgrade-guide-docker-mode"},"nextItem":{"title":"Apache HertzBeat\u2122 1.7.0 \u53d1\u5e03\u516c\u544a","permalink":"/zh-cn/blog/2025/04/10/hertzbeat-v1.7.0"}}')}}]);