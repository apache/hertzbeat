"use strict";(globalThis.webpackChunkhertzbeat=globalThis.webpackChunkhertzbeat||[]).push([[5931],{79574(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>i});var a=t(63876),r=t(86070),s=t(60056);const l={},o="HertzBeat \u5347\u7ea7\u6307\u5bfc-(Docker Mode)",c={authorsImageUrls:[]},i=[{value:"Docker \u65b9\u5f0f\u5347\u7ea7 - Mysql \u6570\u636e\u5e93",id:"docker-\u65b9\u5f0f\u5347\u7ea7---mysql-\u6570\u636e\u5e93",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"docker-\u65b9\u5f0f\u5347\u7ea7---mysql-\u6570\u636e\u5e93",children:"Docker \u65b9\u5f0f\u5347\u7ea7 - Mysql \u6570\u636e\u5e93"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u6570\u636e\u5907\u4efd"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u5907\u4efd\u6570\u636e\u5e93\uff0c\u5c06 mysql \u6570\u636e\u624b\u52a8\u505a\u5907\u4efd\uff0c\u6309\u9700\u5907\u4efd"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'mysqldump -h<HOST-IP> -P`<PORT>` -uroot -p"PASSWORD" <\u5e93\u540d> hertzbeat_backup-`date +%Y-%m-%d`.sql #\u5355\u5e93\u5907\u4efd\nmysqldump -h<HOST-IP> -P`<PORT>` -uroot -p"PASSWORD" > hertzbeat_backup-`date +%Y-%m-%d`.sql # \u6574\u5e93\u5907\u4efd\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u5907\u4efd\u914d\u7f6e\u6587\u4ef6\u53ca\u6570\u636e\u76ee\u5f55"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mv application.yml application-bak.yml && mv sureness-bak.yml\ncp -R data data-`date +%Y-%m-%d`. bak\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u5173\u95ed \u5e76\u79fb\u9664 HertzBeat \u5bb9\u5668"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker stop hertzbeat && docker rm hertzbeat\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u5347\u7ea7\u6570\u636e\u5e93\u811a\u672c"}),"\n",(0,r.jsxs)(n.p,{children:["\u6253\u5f00",(0,r.jsx)(n.a,{href:"https://github.com/apache/hertzbeat/tree/master/hertzbeat-startup/src/main/resources/db/migration",children:"https://github.com/apache/hertzbeat/tree/master/hertzbeat-startup/src/main/resources/db/migration"}),"\uff0c \u9009\u62e9\u4f60\u4f7f\u7528\u7684\u6570\u636e\u5e93\u7684\u76ee\u5f55\u4e0b\u76f8\u5e94\u7684 ",(0,r.jsx)(n.code,{children:"V160__update_column.sql"}),"\u6587\u4ef6\u5728 Mysql \u6267\u884c\u5347\u7ea7 sql\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u66f4\u6362\u955c\u50cf\u91cd\u65b0\u542f\u52a8 HertzBeat \u5bb9\u5668"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ docker run -d -p 1157:1157 -p 1158:1158 \\\n    -v $(pwd)/data:/opt/hertzbeat/data \\\n    -v $(pwd)/logs:/opt/hertzbeat/logs \\\n    -v $(pwd)/application.yml:/opt/hertzbeat/config/application.yml \\\n    -v $(pwd)/sureness.yml:/opt/hertzbeat/config/sureness.yml \\\n    --restart=always \\\n    --name hertzbeat apache/hertzbeat:v1.7.0\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u5347\u7ea7\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,r.jsx)(n.p,{children:"\u53c2\u8003\u5907\u4efd\u914d\u7f6e\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u57fa\u7840\u4e0a\u8fdb\u884c\u4fee\u6539\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"application.yml"}),"\u4e00\u822c\u9700\u8981\u4fee\u6539\u4ee5\u4e0b\u90e8\u5206"]}),"\n",(0,r.jsx)(n.p,{children:"\u9ed8\u8ba4\u4e3a\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"datasource:\n  driver-class-name: com.mysql.cj.jdbc.Driver\n  username: root\n  password: root\n  url: jdbc:mysql://localhost:3306/hertzbeat?useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=Asia/Shanghai\n  hikari:\n    max-lifetime: 120000\n\njpa:\n  show-sql: false\n  database-platform: org.eclipse.persistence.platform.database.MySQLPlatform\n  database: mysql\n  properties:\n    eclipselink:\n      logging:\n        level: SEVERE\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"sureness.yml"}),"\u4fee\u6539\u662f\u53ef\u9009\u7684\uff0c\u4e00\u822c\u5728\u4f60\u9700\u8981\u4fee\u6539\u8d26\u53f7\u5bc6\u7801\u65f6"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# account info config\n# eg: admin has role [admin,user], password is hertzbeat\n# eg: tom has role [user], password is hertzbeat\n# eg: lili has role [guest], plain password is lili, salt is 123, salted password is 1A676730B0C7F54654B0E09184448289\naccount:\n  - appId: admin\n    credential: hertzbeat\n    role: [admin]\n  - appId: tom\n    credential: hertzbeat\n    role: [user]\n  - appId: guest\n    credential: hertzbeat\n    role: [guest]\n  - appId: lili\n    # credential = MD5(password + salt)\n    # plain password: hertzbeat\n    # attention: digest authentication does not support salted encrypted password accounts\n    credential: 94C6B34E7A199A9F9D4E1F208093B489\n    salt: 123\n    role: [user]\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u6dfb\u52a0\u76f8\u5e94\u7684\u6570\u636e\u5e93\u9a71\u52a8"}),"\n",(0,r.jsxs)(n.p,{children:["\u7531\u4e8e apache \u57fa\u91d1\u4f1a\u5bf9\u4e8e license \u5408\u89c4\u7684\u8981\u6c42\uff0cHertzBeat \u7684\u5b89\u88c5\u5305\u4e0d\u80fd\u5305\u542b mysql\uff0coracle \u7b49 gpl \u8bb8\u53ef\u7684\u4f9d\u8d56\uff0c\u9700\u8981\u7528\u6237\u81ea\u884c\u6dfb\u52a0\uff0c\u7528\u6237\u53ef\u901a\u8fc7\u4ee5\u4e0b\u94fe\u63a5\u81ea\u884c\u4e0b\u8f7d\u9a71\u52a8 jar \u653e\u5230\u672c\u5730 ",(0,r.jsx)(n.code,{children:"ext-lib"}),"\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u542f\u52a8\u65f6\u5c06",(0,r.jsx)(n.code,{children:"ext-lib"}),"\u6302\u8f7d\u5230\u5bb9\u5668\u7684 ",(0,r.jsx)(n.code,{children:"/opt/hertzbeat/ext-lib"}),"\u76ee\u5f55\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["mysql\uff1a",(0,r.jsx)(n.a,{href:"https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.18.zip",children:"https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.25.zip"}),"\noracle\uff08\u5982\u679c\u4f60\u8981\u76d1\u63a7 oracle\uff0c\u8fd9\u4e24\u4e2a\u9a71\u52a8\u662f\u5fc5\u987b\u7684\uff09\uff1a\n",(0,r.jsx)(n.a,{href:"https://download.oracle.com/otn-pub/otn_software/jdbc/234/ojdbc8.jar",children:"https://download.oracle.com/otn-pub/otn_software/jdbc/234/ojdbc8.jar"}),"\n",(0,r.jsx)(n.a,{href:"https://repo.mavenlibs.com/maven/com/oracle/database/nls/orai18n/21.5.0.0/orai18n-21.5.0.0.jar?utm_source=mavenlibs.com",children:"https://repo.mavenlibs.com/maven/com/oracle/database/nls/orai18n/21.5.0.0/orai18n-21.5.0.0.jar"})]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},60056(e,n,t){t.d(n,{R:()=>l,x:()=>o});var a=t(30758);const r={},s=a.createContext(r);function l(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),a.createElement(s.Provider,{value:n},e.children)}},63876(e){e.exports=JSON.parse('{"permalink":"/zh-cn/blog/2025/04/23/hertzbeat-upgrade-guide-docker-mode","editUrl":"https://github.com/apache/hertzbeat/edit/master/home/i18n/zh-cn/docusaurus-plugin-content-blog/2025-04-23-hertzbeat-upgrade-guide-docker-mode.md","source":"@site/i18n/zh-cn/docusaurus-plugin-content-blog/2025-04-23-hertzbeat-upgrade-guide-docker-mode.md","title":"HertzBeat \u5347\u7ea7\u6307\u5bfc-(Docker Mode)","description":"Docker \u65b9\u5f0f\u5347\u7ea7 - Mysql \u6570\u636e\u5e93","date":"2025-04-23T00:00:00.000Z","tags":[],"readingTime":2.52,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u56e0\u70ed\u7231\u800c\u8d21\u732e\u5f00\u6e90\uff1a\u5982\u4f55\u4ece\u7528\u6237\u6210\u957f\u4e3a Apache HertzBeat\u2122 \u7684 PPMC \u6210\u5458","permalink":"/zh-cn/blog/2025/5/19/new-pmc"},"nextItem":{"title":"HertzBeat \u4ece 1.6.1 \u7248\u672c\u5347\u7ea7\u5230 1.7.0 \u7248\u672c\u6307\u5f15-(Helm Mode)","permalink":"/zh-cn/blog/2025/04/23/hertzbeat-upgrade-guide-from-v1.6.1-to-v1.7.0-helm-mode"}}')}}]);